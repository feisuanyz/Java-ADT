### 1. 微服务治理

#### 1.1 通过Nacos修改配置信息

全自动开发平台支持对接Nacos，用户可以在自行搭建好Nacos后，通过新建bootstrap.yml文件即可实现在Nacos上修改已部署项目的相关资源实例及配置组的配置信息，无需重新部署项目。

##### 1.1.1 操作步骤

a）在项目jar包同级目录下新建如下所示的bootstrap.yml文件，将enabled设置为true，打开Nacos的配置开关；同时需保证yml文件中的地址与Nacos配置资源实例中填写的地址一致，保存该yml文件即可，如图1-1所示：

![1-1](https://www.feisuanyz.com/fsimage/zc-image/microservice/microservice_4.png)

##### 图1-1 新建bootstrap.yml文件

![1-2](https://www.feisuanyz.com/fsimage/zc-image/microservice/microservice_5.png)

##### 图1-2 将enabled设置为true

图1-2所示具体代码如下：

```
spring:
  cloud:
    nacos:
      config:
        enabled: true
        server-addr: ${NACOS_HOST:127.0.0.1}:${NACOS_PORT:8080}
      discovery:
        enabled: true
        server-addr: ${NACOS_HOST:127.0.0.1}:${NACOS_PORT:8080}
```

b）启动项目后，在浏览器中输入Nacos地址（即Nacos配置资源实例中填写的地址），登录Nacos服务进入Nacos页面；在服务列表中输入服务名称（即部署项目的项目路径）进行查询，若能查询出来，则说明配置成功，如图1-3所示：

![1-3](https://www.feisuanyz.com/fsimage/zc-image/microservice/microservice_6.png)

##### 图1-3 输入服务名称

c）选择Nacos页面中的配置管理，单击配置列表，输入项目的Group（即部署项目包的环境路径，部署环境-项目路径）进行查询，如图1-4所示：

![1-4](https://www.feisuanyz.com/fsimage/zc-image/microservice/microservice_7.png)

##### 图1-4 输入项目Group

d）查询出当前项目的所有资源实例或配置组的信息后，用户可根据需求进行修改。例：编写defaultGroup数据，如图1-5所示：

![1-5](https://www.feisuanyz.com/fsimage/zc-image/microservice/microservice_8.png)

##### 图1-5 编写defaultGroup数据

e）修改对应配置内容，点击发布，然后重启服务即可生效，无需重新部署版本，如图1-6所示：

![1-6](https://www.feisuanyz.com/fsimage/zc-image/microservice/microservice_9.png)

##### 图1-6 配置内容

#### 1.2 使用FeignCient组件进行微服务调用

全自动开发平台提供了FeignClient组件，通过在HTTP通信的资源实例中配置对应接口所在项目的项目路径地址，无需配置IP地址，Nacos服务就会去寻找项目路径地址所部署的IP地址，并与请求地址拼接成完整的请求URL，这样就可以请求到其它接口的数据。若项目后续变更环境，也无需修改HTTP通信资源实例中的URL信息。

##### 前提条件

项目中已加载好FeignClient组件、Nacos配置资源、Http通信资源，具体可参见[《SoFlu社区版快速入门教程：4.9 如何加载资源》](https://gitee.com/feisuanyz/SoFlu-adp/blob/master/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E6%95%99%E7%A8%8B/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B.md)。

![1-7](https://www.feisuanyz.com/fsimage/zc-image/microservice/feignclient_1.png)

##### 图1-7 FeignClient组件

![1-8](https://www.feisuanyz.com/fsimage/zc-image/microservice/feignclient_2.png)

##### 图1-8 Nacos配置资源和Http通信资源

##### 1.2.1 操作步骤
