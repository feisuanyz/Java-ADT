### 2. 电商平台应用

#### 2.3 新增商品秒杀活动

如今互联网电商蓬勃发展，各类购物节活动层出不穷，秒杀活动也是我们经常会遇到的一种。本文将为您介绍如何利用全自动开发平台实现新增商品秒杀活动的功能。案例主要用到了全自动开发平台中的单函数组件、单SQL组件、互斥条件组件以及赋值组件等，通过绘制组件流程图并进行组件配置相当于编写复杂代码，同时通过流程图的可视化展示，我们可以清晰地看出功能实现的逻辑关系。对比敲代码，开发过程变得更加有趣便捷。

##### 2.3.1 效果展示

新增商品秒杀活动时，一般是在如图2-111所示的前端页面录入秒杀活动信息后，通过多重判断来确定是否新增秒杀活动信息（即开启秒杀活动）。由于本案例仅针对后端程序进行开发，录入秒杀活动信息由全自动开发平台测试用例页面直接录入对应的秒杀活动信息即可，如图2-112所示。最后通过测试用例执行结果是否成功以及数据库中秒杀表是否新增记录来判断功能实现结果，如图2-113、2-114所示：

![2-111](https://www.feisuanyz.com/fsimage/alcj-image/miaosha/2_1.jpg)

##### 图2-111 前端页面

![2-112](https://www.feisuanyz.com/fsimage/alcj-image/miaosha/2_2.png)

##### 图2-112 全自动开发平台参数录入界面

![2-113](https://www.feisuanyz.com/fsimage/alcj-image/miaosha/2_3.png)

##### 图2-113 测试用例执行结果

![2-114](https://www.feisuanyz.com/fsimage/alcj-image/miaosha/2_4.png)

##### 图2-114 秒杀表新增记录

##### 2.3.2 准备工作

提前准备功能实现过程中需用到的两张数据表：秒杀表seckill_buy（用于存储商品秒杀活动信息），商品表goods_info（用于存储商品信息），表结构设计及相关数据如下所示：

商品表goods_info：

```
 CREATE TABLE `goods_info` (
  `goods_id` varchar(24) NOT NULL COMMENT '商品编号',
  `goods_name` varchar(100) DEFAULT '' COMMENT '商品名称',
  `goods_remark` varchar(300) DEFAULT '' COMMENT '商品简介',
  `keyword` varchar(100) DEFAULT NULL COMMENT '商品关键字',
  `provider_id` varchar(24) DEFAULT NULL COMMENT '供应商',
  `goods_type_id` varchar(300) DEFAULT NULL COMMENT '商品类别 ',
  `goods_status` int(11) DEFAULT NULL COMMENT '商品状态 1仓库中 2审核中 3出售中 4已删除',
  `sort_id` int(11) DEFAULT NULL COMMENT '排序 默认0',
  `goods_pic_url` varchar(200) DEFAULT '' COMMENT '封面图',
  `recommend_pic_url` varchar(200) DEFAULT NULL COMMENT '推荐图',
  `video_link` varchar(200) DEFAULT NULL COMMENT '主图视频',
  `create_user` varchar(24) DEFAULT NULL COMMENT '创建人',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
  `update_user` varchar(24) DEFAULT NULL COMMENT '更新人',
  `update_time` datetime DEFAULT NULL COMMENT '更新时间',
  `context_html_url` varchar(200) DEFAULT NULL COMMENT '商品内容HTML文件地址',
  `sale_price` decimal(10,2) DEFAULT 0.00 COMMENT '售价',
  `from_price` decimal(10,2) DEFAULT 0.00 COMMENT '原价',
  `data_from` int(11) DEFAULT 1 COMMENT '数据来源1后台2供应商',
  `remain_amount` int(11) DEFAULT NULL COMMENT '库存',
  PRIMARY KEY (`goods_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='商品表';
```

![2-115](https://www.feisuanyz.com/fsimage/alcj-image/miaosha/3_1.png)

##### 图2-115 商品表参数1

![2-116](https://www.feisuanyz.com/fsimage/alcj-image/miaosha/3_2.png)

##### 图2-116 商品表参数2

![2-117](https://www.feisuanyz.com/fsimage/alcj-image/miaosha/3_3.png)

##### 图2-117 商品表参数3

##### 说明：商品表中的配置信息可自行设置。

秒杀表seckill_buy：

```
CREATE TABLE `seckill_buy` (
  `seckill_buy_id` varchar(24) NOT NULL DEFAULT '' COMMENT '秒杀编号',
  `seckill_buy_name` varchar(200) DEFAULT '' COMMENT '秒杀名称',
  `goods_id` varchar(24) NOT NULL COMMENT '商品编号',
  `seckill_buy_remark` varchar(300) DEFAULT '' COMMENT '秒杀简介',
  `start_time` datetime DEFAULT NULL COMMENT '秒杀开始时间',
  `end_time` datetime DEFAULT NULL COMMENT '秒杀结束时间',
  `seckill_buy_status` int(2) DEFAULT 1 COMMENT '秒杀状态 1待开启2开启中3已结束4已关闭',
  `seckill_price` decimal(10,2) DEFAULT 0.00 COMMENT '秒杀价格',
  `remain_amount` int(11) DEFAULT 0 COMMENT '剩余数量',
  `limit_buy_amount` int(11) DEFAULT 0 COMMENT '限购数量',
  `finish_reason` tinyint(2) DEFAULT 1 COMMENT '结束原因 1秒杀商品卖完2超时结束3自动关闭',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
  `create_user` varchar(24) DEFAULT NULL COMMENT '创建人',
   PRIMARY KEY (`seckill_buy_id`),
   KEY `goods_id` (`goods_id`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='秒杀表';
```

![2-118](https://www.feisuanyz.com/fsimage/alcj-image/miaosha/3_4.png)

##### 图2-118 秒杀表参数3

##### 说明：秒杀表数据在调用接口后自动生成。

##### 2.3.3 流程图设计概览

![2-119](https://www.feisuanyz.com/fsimage/alcj-image/miaosha/4_1.png)
