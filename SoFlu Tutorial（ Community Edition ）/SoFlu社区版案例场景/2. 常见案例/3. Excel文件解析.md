### 3. Excel文件解析

#### 3.1 Excel文件解析

Excel文件解析，主要是利用全自动开发平台上传Excel文件（例如：一份打卡记录表），通过读取并解析出Excel文件中的内容，对Excel文件中的数据进行处理，输出我们想要的内容（本案例具体表现为：输出员工的上班时间）。案例综合使用了全自动开发平台中的单函数、计数器、互斥条件等组件以及相关函数进行接口流程图设计，通过流程图我们可以清晰地看出功能的实现逻辑，便捷好用，体现了全自动开发平台的独特优势。

##### 3.1.1 效果展示

a）上传的Excel文件内容：一份打卡记录表，如图3-1所示：

![3-1](https://www.feisuanyz.com/fsimage/alcj-image/excel/excel_1.png)

##### 图3-1 Excel文件

b）经平台读取并解析后的输出结果：展示出每名员工的上班时间，如图3-2所示：

![3-2](https://www.feisuanyz.com/fsimage/alcj-image/excel/excel_2.png)

##### 图3-2 展示上班时间

##### 3.1.2 流程图设计概览

a）上传的Excel文件内容：一份打卡记录表，如图3-3所示：

![3-3](https://www.feisuanyz.com/fsimage/alcj-image/excel/excel_3.png)

##### 图3-3 流程图

##### 3.1.3 操作步骤

a）在全自动开发平台新增一个接口，填写接口的基本信息，如图3-4所示：

![3-4](https://www.feisuanyz.com/fsimage/alcj-image/excel/excel_4.png)

##### 图3-4 填写基本信息

b）配置接口的入口参数file（字段类型为File），用于上传Excel文件，如图3-5所示：

![3-5](https://www.feisuanyz.com/fsimage/alcj-image/excel/excel_5.png)

##### 图3-5 配置入口参数

c）通过拖、拽、拉的方式进行模型编辑（即接口流程图设计），如图3-6所示：

![3-6](https://www.feisuanyz.com/fsimage/alcj-image/excel/excel_7.png)

##### 图3-6 配置入口参数

d）组件的具体配置展示。

d1）单函数组件【读取Excel文件】： 使用的函数为getNormalExcelData(File file,int sheetNum)，需传入接口参数file以及sheet页码0，返回Excel记录集合list，如下图所示。

说明：a）getNormalExcelData(File file,int sheetNum)函数无须指定字段名，字段名默认返回为F1、F2...；b）因上传的Excel文件为单页面，而sheet页码默认从0开始计数，故此处sheet页码数填写0。

![3-7](https://www.feisuanyz.com/fsimage/alcj-image/excel/excel_8.png)

##### 图3-7 单函数组件

![3-8](https://www.feisuanyz.com/fsimage/alcj-image/excel/excel_9.png)

##### 图3-8 填写数据

![3-9](https://www.feisuanyz.com/fsimage/alcj-image/excel/excel_10.png)

##### 图3-9 函数描述

d2）单函数组件【获取Excel文件的记录条数】： 使用的函数为listSize(List sourceList)，用于获取List大小，需传入单函数组件【读取Excel文件】获取到的Excel记录集合list，如下图所示。

![3-10](https://www.feisuanyz.com/fsimage/alcj-image/excel/excel_11.png)

##### 图3-10 单函数组件

![3-11](https://www.feisuanyz.com/fsimage/alcj-image/excel/excel_12.png)

##### 图3-11 填写数据

d3）遍历流程： 逐条遍历Excel记录集合，获取每条记录中【时间】字段的首个打卡时间，最后按所需格式拼接获取的内容，如图3-12所示：

![3-12](https://www.feisuanyz.com/fsimage/alcj-image/excel/excel_16.png)
