### 7. 计算学生各科总成绩

#### 7.1 系统站内信推送

本节案例主要实现通过录入学生学号，查询该学生各科成绩，从而计算该学生的各科成绩总和。案例不仅涉及单SQL组件、单函数组件、计数器组件、赋值组件等多种组件的使用，还综合运用了资源实例、实体模型、SQL管理、接口生成器功能模块，可以较好地体现全自动开发平台的功能。

##### 7.1.2 准备工作

a）在数据库中准备3张数据表并配上相应的数据。

##### 学生表：

![7-1](https://www.feisuanyz.com/fsimage/alcj-image/chengji/1.png)

##### 图7-1 学生表

##### 课程表：

![7-2](https://www.feisuanyz.com/fsimage/alcj-image/chengji/2.png)

##### 图7-2 课程表

##### 成绩表：

![7-3](https://www.feisuanyz.com/fsimage/alcj-image/chengji/3.png)

##### 图7-3 成绩表

b）创建项目

##### 具体可参见[《SoFlu社区版快速入门教程第4.1节：如何创建项目》](https://gitee.com/feisuanyz/SoFlu-adp/blob/master/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E6%95%99%E7%A8%8B/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B.md#41-%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE)

![7-4](https://www.feisuanyz.com/fsimage/alcj-image/chengji/4.png)

##### 图7-4 创建项目

c）向项目中添加组件、平台自定义函数、数据库中间件资源等加载项

##### 具体可参见[《SoFlu社区版快速入门教程第4.9节：如何加载资源》](https://gitee.com/feisuanyz/SoFlu-adp/blob/master/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E6%95%99%E7%A8%8B/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B.md#49-%E5%A6%82%E4%BD%95%E5%8A%A0%E8%BD%BD%E8%B5%84%E6%BA%90)

![7-5](https://www.feisuanyz.com/fsimage/alcj-image/chengji/11.png)

##### 图7-5 添加组件1

![7-6](https://www.feisuanyz.com/fsimage/alcj-image/chengji/6.png)

##### 图7-6 添加组件2

![7-7](https://www.feisuanyz.com/fsimage/alcj-image/chengji/7.png)

##### 图7-7 添加组件3

![7-8](https://www.feisuanyz.com/fsimage/alcj-image/chengji/8.png)

##### 图7-8 添加组件4

![7-9](https://www.feisuanyz.com/fsimage/alcj-image/chengji/9.png)

##### 图7-9 添加组件5

![7-10](https://www.feisuanyz.com/fsimage/alcj-image/chengji/10.png)

##### 图7-10 添加函数

![7-11](https://www.feisuanyz.com/fsimage/alcj-image/chengji/12.png)

##### 图7-11 添加资源

d）使用数据库中间件资源创建嵌入式直连DB连接

##### 具体可参见[《SoFlu社区版基础操作指南第10.1.13节：如何新增数据库中间件资源》](https://gitee.com/feisuanyz/SoFlu-adp/blob/master/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E6%95%99%E7%A8%8B/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C%E6%8C%87%E5%8D%97/10.%20%E8%B5%84%E6%BA%90%E5%AE%9E%E4%BE%8B/1.%20%E6%96%B0%E5%A2%9E%E8%B5%84%E6%BA%90%E5%AE%9E%E4%BE%8B.md#113-%E6%96%B0%E5%A2%9E%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E9%97%B4%E4%BB%B6%E8%B5%84%E6%BA%90)

可以采用直接填写配置项，也可以通过点击数据库连接来配置。

![7-12](https://www.feisuanyz.com/fsimage/alcj-image/chengji/13.png)

##### 图7-12 填写配置项

![7-13](https://www.feisuanyz.com/fsimage/alcj-image/chengji/15.png)

##### 图7-13 点击数据库连接

![7-14](https://www.feisuanyz.com/fsimage/alcj-image/chengji/14.png)

##### 图7-14 修改数据库连接

e）利用接口生成器自动生成实体模型和SQL信息

##### 具体可参见[《SoFlu社区版基础操作指南第12.2.3节：自动生成实体模型》](https://gitee.com/feisuanyz/SoFlu-adp/blob/master/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E6%95%99%E7%A8%8B/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C%E6%8C%87%E5%8D%97/12.%20%E5%AE%9E%E4%BD%93%E6%A8%A1%E5%9E%8B/2.%20%E5%AE%9E%E4%BD%93%E6%A8%A1%E5%9E%8B.md#23-%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E5%AE%9E%E4%BD%93%E6%A8%A1%E5%9E%8B)及[《SoFlu社区版快速入门教程第4.10节：如何自动生成SQL信息》](https://gitee.com/feisuanyz/SoFlu-adp/blob/master/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E6%95%99%E7%A8%8B/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/SoFlu%E7%A4%BE%E5%8C%BA%E7%89%88%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B.md#410-%E5%A6%82%E4%BD%95%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90sql%E4%BF%A1%E6%81%AF)

![7-15](https://www.feisuanyz.com/fsimage/alcj-image/chengji/16.png)

##### 图7-15 选择数据1

![7-16](https://www.feisuanyz.com/fsimage/alcj-image/chengji/17.png)

##### 图7-16 选择数据2

![7-17](https://www.feisuanyz.com/fsimage/alcj-image/chengji/18.png)

##### 图7-17 生成实体模型

![7-18](https://www.feisuanyz.com/fsimage/alcj-image/chengji/19.png)

##### 图7-18 生成系统SQL

##### 7.1.2 功能实现

a）新增接口模块，新增接口，如图

![7-19](https://www.feisuanyz.com/fsimage/alcj-image/chengji/20.png)

##### 图7-19 编辑接口模块

![7-20](https://www.feisuanyz.com/fsimage/alcj-image/chengji/21.png)

##### 图7-20 编辑接口信息：基本信息

![7-21](https://www.feisuanyz.com/fsimage/alcj-image/chengji/22.png)

##### 图7-21 编辑接口信息：入参列表

b）流程图编辑

流程图概览：

![7-22](https://www.feisuanyz.com/fsimage/alcj-image/chengji/23.png)

##### 图7-22 流程图概览

单SQL组件（【查询】学生成绩）：根据学生学号在成绩表中查询该学生各科成绩，具体配置如图7-23、图7-24、图7-25、图7-26所示：

![7-23](https://www.feisuanyz.com/fsimage/alcj-image/chengji/24.png)

##### 图7-23 单SQL组件

![7-24](https://www.feisuanyz.com/fsimage/alcj-image/chengji/25.png)

##### 图7-24 填写数据

![7-25](https://www.feisuanyz.com/fsimage/alcj-image/chengji/26.png)

##### 图7-25 SQL内容

![7-26](https://www.feisuanyz.com/fsimage/alcj-image/chengji/27.png)

##### 图7-26 参数选择

单函数组件（取成绩列表大小）：计算查询到的学生成绩列表记录条数，即该学生有几科成绩需要进行累加，具体配置如图7-27所示：

![7-27](https://www.feisuanyz.com/fsimage/alcj-image/chengji/28.png)
