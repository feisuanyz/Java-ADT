### 5. 自定义组件

#### 5.1 自定义组件

开发一个组件必须要遵循必要的规范，比如：实现统一的接口、符合SPI机制，本节将详细介绍如何自定义组件。

#### 5.1.1 前提条件

自定义组件需要下载如下Demo工程包和开发辅助工具，具体如下：

a）组件Demo工程包下载地址：demo-component.zip

b）下载开发辅助工具：在全自动开发平台中，单击右上角下载开发辅助工具，如图1-1所示：

![1-1](https://www.feisuanyz.com/fsimage/gj-image/gj_0000_img.png)

##### 图1-1 下载开发辅助工具

#### 5.1.2 操作步骤

a）编辑pom.xml文件，在pom.xml文件中增加依赖包。

包名：` com.feisuanyz.flow.component.FlowComponent `

类名：` FlowComponent `

```
<dependency>
     <groupId>com.feisuanyz.flow</groupId>
     <artifactId>flow-core-cmpt</artifactId>
     <version>${version}</version>
     <scope>provided</scope>
     <systemPath>${开发辅助工具路径}/flow-core-cmpt-${version}.jar</systemPath>
</dependency>
```

b）开发实现FlowComponent接口。

包名：` com.feisuanyz.flow.component.FlowComponent `

类名：` FlowComponent `

实现方法：

```
/**
 * 执行组件
 * @param parameter 组件参数
 * @throws FlowComponentException 异常
 */
void execute(FlowComponentParameter parameter) throws FlowComponentException
```

c）获取入参。

##### 说明：入参是指能够传入到组件的参数内容，组件中能够使用的参数都必须在定义组件的时候定义入参，数据类型必须要和实际传入的数据类型相符，否则将会抛出FlowComponentException异常。

下面介绍获取参数的方式：

c1）获取单条记录的参数值

` parameter.getInputParameter("parameterName",类型); `

c2）获取多条记录的参数值

` parameter.getInputParameterArray("parameterName",类型); `

d）设置出参。

##### 说明：出参是指流转到下一个组件的参数内容，所有的输出都必须在定义组件的时候定义出参，数据类型必须要和实际传出的数据类型相符，否则将会抛出FlowComponentException异常。

下面介绍设置出参的方式：

` parameter.setOutputParameter("parameterName",value); `

##### 说明：如果出参定义了默认值，又没有对输出参数进行赋值，则程序会自动将默认值赋到出参。

e）定义方式

组件的定义需要按照以下` xml `格式进行描述，文件名必须为：` components.xml `，然后存放到项目中的` resources `目录下，一起打成` jar `包上传到平台即可。

XML文件示例如下：
