### 3. 案例演示

#### 3.1 基于token登录验证功能测试场景配置

当用户直接通过URL访问特定页面时，一般会遇到这样的情况，若未登录当前网站，则会被重新导航至登录页面，若已登录过当前网站，才可以通过URL直接访问特定页面。

内部实现逻辑可参考如下：

a）客户端输入用户名和密码向服务器端发起验证；

b）服务器端验证通过之后根据某种规则生成用户的token并返回，token保存在redis中，以保证不同服务器间的共享；

c）客户端存储该token，可以存储在sessionStorage或者cookie中；

d）后续服务器的每次请求都在请求头携带token发送到服务端；

e）服务端在执行方法前先对请求进行验证，取出token查询redis中有没有对应的值。

本节将使用全自动测试平台测试登录验证功能中的两个接口，通过配置合适的测试场景，来检测登录验证功能是否可以正常实现。

##### 3.1.1 测试场景配置说明

##### a）关联接口：

a1）接口A：登录验证接口，用于提取用户的token信息，存储到cookie管理器中。

a2）接口B：查询接口，即登录验证成功之后的特定页面，若接口A提取到了正确的token信息，则接口B可以请求成功。

##### b）测试目的：

b1）测试是否通过请求接口A获取到了token值。

b2）测试接口B是否可以请求成功，以检测token值是否正确。

##### c）场景配置大致流程：

c1）创建变量集：用于创建请求头参数userID。

c2）创建场景组：用于将后续所有场景配置归属到同一场景组。

c3）创建cookie管理器：用于存储提取的token信息。

c4）创建信息头管理器：用于为当前场景组所有请求接口添加固定的头部参数userID。

c5）为当前场景组关联接口A。

c6）创建正则提取器：通过设置正确的正则表达式来提取接口A响应头中的token值。

c7）为当前场景组关联接口B。

c8）设置响应断言：通过判断接口B响应体信息中是否包含id、name字段信息，来判断接口B是否请求成功。

c9）保存场景配置，执行测试场景，查看执行报告。

##### 3.1.2 前置条件

a）所在测试项目已做好环境配置，否则无法添加测试接口并执行测试场景，具体操作可参见《SoFlu全自动测试平台教程操作指南第2.1.9节：新增环境配置》；

b）测试用例模块中已创建对应接口测试用例，否则无法选择测试用例进行场景配置，具体操作可参见《SoFlu全自动测试平台教程操作指南第2.3.1.1节：新增测试用例》；

c）接口管理模块中已添加需测试的接口，否则进行场景配置时无法关联对应的接口，具体操作可参见《SoFlu全自动测试平台教程操作指南第2.4.2.4节：新增接口》。

##### 3.1.3 场景配置具体操作
