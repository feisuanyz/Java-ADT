### 5. 性能测试

#### 5.2 查看性能测试报告

##### 5.2.4 查看测试报告监控数据

全自动测试平台支持调用Promentheus进行数据监控，用户可以在测试报告查看监控收集到的数据。

##### 5.2.4.1 基本概述

a）用户需要先安装prometheus监控工具；

b）然后在被测试的服务器上安装node_exporter插件，用于将在被测试的服务器上收集的性能指标参数传给prometheus；

c）在平台上执行完性能测试后，测试报告上会显示收集的CPU、内存、磁盘以及网卡输入输出等变化指标信息；

d）用户可根据收集的数据进行系统分析和调优。

##### 5.2.4.2 操作步骤

a）在 https://prometheus.io/download/ 下载最新版本的promentheus和node_exporter。

b）使用xftp传输工具将prometheus安装包上传至服务器A，同时解压到/usr/local目录下（默认端口为9090）。

c）解压之后可以看到prometheus和promentheus.yml两个文件，如图3-1所示：

![3-1](https://www.feisuanyz.com/fstest/xncs/ceshireport/jiankongjicheng_3.jpg)

##### 图3-1 解压prometheus安装包

d）再次使用xftp传输工具将node_exporter安装包上传至被测试的服务器B同时解压到/usr/local目录下（默认端口9100）。

e）从服务器A进入prometheus.yml文件，创建名为node_controller1的job，并配置node_exporter地址，如图3-2所示：

##### 说明：若需监控多台服务器，则创建多个job即可。

![3-2](https://www.feisuanyz.com/fstest/xncs/ceshireport/jiankongjicheng_5.jpg)

##### 图3-2 promentheus.yml文件配置

f）分别启动node_exporter和prometheus，如图3-3、3-4所示，若显示端口被占用，则说明启动成功：

![3-3](https://www.feisuanyz.com/fstest/xncs/ceshireport/jiankongjicheng__6_2.jpg)

##### 图3-3 启动node_exporter

![3-4](https://www.feisuanyz.com/fstest/xncs/ceshireport/jiankongjicheng_6_1.jpg)

##### 图3-4 启动prometheus

g）打开浏览器，访问http://服务器A地址：9090，就可以看到服务器B的监控，如图3-5所示：

![3-5](https://www.feisuanyz.com/fstest/xncs/ceshireport/jiankongjicheng_7.jpg)

##### 图3-5 查看监控

h）进入全自动测试平台，单击右上角“系统设置”选项，进入系统设置页面，选择“系统 > 系统参数”，如图3-6所示：

![3-6](https://www.feisuanyz.com/fstest/xncs/ceshireport/jiankongjicheng_8.png)

##### 图3-6 系统设置页面

i）输入prometheus地址，如图3-7所示：

![3-7](https://www.feisuanyz.com/fstest/xncs/ceshireport/jiankongjicheng_9.png)

##### 图3-7 系统参数页面

j）在系统设置页面，再次选择“服务 > 资源池管理”。

k）选择一个资源池，单击“资源管理”选项，进入资源管理页面。

l）在新增或修改资源时，输入监控指标地址（即服务器B的地址），如图3-8所示：

![3-8](https://www.feisuanyz.com/fstest/xncs/ceshireport/jiankongjicheng_10.png)

##### 图3-8 新增或修改资源页面

m）在全自动测试平台页面上方，选择“性能测试”功能模块，在新增或修改性能测试时，选择对应的资源池，如图3-9所示：

![3-9](https://www.feisuanyz.com/fstest/xncs/ceshireport/jiankongjicheng_11.png)

##### 图3-9 新增或修改性能测试页面

n）执行性能测试并查看测试报告，在测试报告页面单击“监控详情”页签，便可查看服务器B的监控数据，您也可以通过切换地址查看多台服务器的监控数据，如图3-10所示：

![3-10](https://www.feisuanyz.com/fstest/xncs/ceshireport/jiankongjicheng_11.png)

##### 图3-10 测试报告页面
