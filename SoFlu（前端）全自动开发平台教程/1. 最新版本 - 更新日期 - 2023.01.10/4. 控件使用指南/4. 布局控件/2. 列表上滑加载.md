### 4. 控件使用指南

#### 4.4 布局控件

#### 4.4.2 列表上滑加载

列表上滑加载组件使用瀑布流滚动加载，用于展示长列表，当列表滚动到底部时，会触发事件并加载更多列表项。

#### 4.4.2.1 基本属性

a）组件描述：可输入对控件的描述，字符限制在200字符以内。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-1.png)

##### 图2-1 组件描述

b）是否加载完成：开启该状态后表示列表已经加载完成，不再触发加载事件，可绑定变量赋值判断是否加载完成。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-2.png)

##### 图2-2 是否加载完成

c）是否加载失败：开启该状态后表示加载失败，不再触发加载事件，可绑定变量赋值判断是否加载失败。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-3.png)

##### 图2-3 是否加载失败

d）触发加载时距离底部的距离（px）：滚动条与底部距离小于该值时触发加载。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-4.png)

##### 图2-4 触发加载时距离底部的距离

e）加载中提示文案：加载过程中提示的文案。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-5.png)

##### 图2-5 加载中提示文案

f）加载完成提示文案：加载完成后提示的文案。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-6.png)

##### 图2-6 加载完成提示文案

g）加载失败提示文案：加载失败后提示的文案。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-7.png)

##### 图2-7 加载失败提示文案

h）动作面板：支持绑定控件滑动到底部时的动作，当符合动作条件时会触发相应的动作。详情见《SoFlu（前端）全自动开发平台教程第3.3.16节至3.3.20节》绑定动作部分。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-8.png)

##### 图2-8 动作面板

#### 4.4.2.2 操作案例

列表上滑加载组件使用瀑布流滚动加载，用于展示长列表，当列表滚动到底部时，会触发事件并加载更多列表项。

#### 4.4.2.2.1 在页面上滑加载数据

前提条件：准备一个能返回分页列表数据的后端接口，数据格式参考如下：

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-9.png)

##### 图2-9 数据格式参考

a）在左侧控件库，拖入一个容器控件，并设置容器高度，再将列表上滑加载控件拖入到容器中。在列表上滑加载控件中，拖入需要展示数据的控件（此处以文本控件为例）。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-10.png)

##### 图2-10 拖入需要展示数据的控件

b）单击上方变量设置，新增四个页面变量，分别是 “index”（初始值为0）、“text”、“textAccount（初始值为[]）” 以及 “a（初始值为false）”。

```
说明：

b1）index：分页页数

b2）text：分页数据

b3）textAccount：列表总数据

b4）a：控制是否加载完成，“true”表示加载完成，“false”表示加载未完成。
```

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-11.png)

##### 图2-11 新增四个页面变量

c）单击上方页面函数，在函数代码开发页面，新增三个函数，函数及方法参考下图：

```
说明：


c1）pushList(data)： 用于将获取的当前页数据（text）追加到所有列表数据（textAccount）中。

c2）pageIn()： 用于当函数被调用时，当前分页页数（index）自增+1。

c3）lenth()： 用于函数被调用时，判断当前列表是否还有数据，如果没有数据，则判断加载完成（即a为“true”）。
```

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-12.png)

##### 图2-12 函数及方法参考

d）选中列表上滑加载控件，单击右侧属性栏是否加载完成旁的变量绑定按钮，选择页面变量 > a。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-13.png)

##### 图2-13 选择页面变量

e）单击绑定动作 > 当滑动到底部时，在绑定动作页面选择对应的项目和接口。填写或绑定下方带出的接口请求参数。

```
请求参数说明：

e1）第一个参数左边绑定接口请求参数“pageIndex（当前分页页数）”，右边绑定页面函数pageIn()。

e2）第二个参数左边绑定接口请求参数 “pageSize（分页数据）”， 右边手动赋值为 “5”。
```

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-14.png)

##### 图2-14 选择对应的项目和接口

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-15.png)

##### 图2-15 填写或绑定下方带出的接口请求参数

f）在单击响应成功处理旁的新增处理动作，新增三个动作处理，分别是：

```
动作处理说明：

f1）填写判断条件，执行动作选择数据处理，左边绑定页面变量“text”，右边绑定接口响应数据“data.records”，如图2-16所示。

f2）填写判断条件，执行动作选择函数处理，绑定函数“pushList()”，中间参数选择 “text（分页数据）”，如图2-17所示。

f3）填写判断条件，执行动作选择函数处理 ，绑定函数“lenth()”，如图2-18所示。
```

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-16.png)

##### 图2-16 动作处理说明1

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-17.png)

##### 图2-17 动作处理说明2

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/4.%20%E5%B8%83%E5%B1%80%E6%8E%A7%E4%BB%B6/2-18.png)

##### 图2-18 动作处理说明3
