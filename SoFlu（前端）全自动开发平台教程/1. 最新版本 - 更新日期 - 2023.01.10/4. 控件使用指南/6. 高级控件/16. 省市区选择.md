### 4. 控件使用指南

#### 4.6 高级控件

#### 4.6.16 省市区选择

省市区选择组件只支持移动端，用于移动端的城市选择器。选项选中的值即为该组件的值。

#### 4.6.16.1 基本属性

a）组件描述：可输入对组件的描述，字符限制在200字符以内。

![image](https://user-images.githubusercontent.com/79617492/227877579-fc0d1706-928f-4d1d-806f-84c7dc142227.png)

##### 图16-1 组件描述

b）占位提示文字：配置每一列的占位提示文字。

![image](https://user-images.githubusercontent.com/79617492/227877598-98403541-34b0-485e-995f-96df060f0072.png)

##### 图16-2 占位提示文字

c）显示列：配置省市区显示的列数，默认显示省市。

![image](https://user-images.githubusercontent.com/79617492/227877620-6da9b9c1-6526-4d2d-aaef-d83a246da2a1.png)

##### 图16-3 显示列

d）标题：可输入组件的标题，字符限制在20字符以内。

![image](https://user-images.githubusercontent.com/79617492/227877645-f9d2bbe5-43a8-4e91-98f3-24beb334476a.png)

##### 图16-4 标题

e）默认选中值：可输入省市区编号，设置初始选中值。

![image](https://user-images.githubusercontent.com/79617492/227877667-83df8ef7-bccf-4009-b5c8-2103b75bd6ab.png)

##### 图16-5 默认选中值

f）自定义数据源：开启后可分别手动或绑定变量设置省、市、区数据源。

##### 说明：每项以地区码作为key，省市区名字作为value。地区码为6位数字，前两位代表省份，中间两位代表城市，后两位代表区县，以0补足6位，例如北京的地区码为11，以0补足6位，编码格式为110000。

![image](https://user-images.githubusercontent.com/79617492/227877719-37037ad7-2279-43c6-a715-87ba1f36eb28.png)

##### 图16-6 自定义数据源

![image](https://user-images.githubusercontent.com/79617492/227877793-019abf14-f925-4855-b2ff-b7fc4594e13d.png)

##### 图16-7 自定义数据源

g）动作面板：支持绑定控件点击完成按钮时和点击取消按钮时的动作，当符合条件时，会触发相应动作。详情见《SoFlu（前端）全自动开发平台教程第3.3.16节至3.3.20节》绑定动作部分。

![image](https://user-images.githubusercontent.com/79617492/227877825-f2329b4c-d836-4d20-9a1d-3871996ecb16.png)

##### 图16-8 动作面板

#### 4.6.16.2 操作案例

案例介绍如何点击输入框选择省市区以及动态获取省市区数据。

#### 4.6.16.2.1 点击输入框选择省市区

a）在页面开发界面，切换为手机模式，从左侧控件库中拖入一个省市区选择控件和一个输入框控件到右侧画布，并隐藏省市区选择控件。

![image](https://user-images.githubusercontent.com/79617492/227877859-5568e941-edea-4e32-9100-20d5ddde25d9.png)

##### 图16-9 拖入控件

b）单击上方变量设置，新增6个页面变量，如下图：

```
变量说明：

b1）display：控制省市区选择控件是否显示，true为显示，false为不显示

b2）ssq：用于显示省市区拼接后的值。

b3）province：省份

b4）city：城市

b5）area：区县

b6）text：用于接收省市区选择控件的值
```

![image](https://user-images.githubusercontent.com/79617492/227877886-7312f15c-1e88-4dc3-b8dd-46cd053d84ad.png)

##### 图16-10 新增6个页面变量

c）单击右侧属性栏高级 > 是否显示的变量绑定按钮，在变量绑定页面，选择页面变量 > display。

![image](https://user-images.githubusercontent.com/79617492/227878024-5dfd5f45-2062-4683-b8cb-6e8eab9a52dc.png)

##### 图16-11 选择页面变量 > display

d）单击上方页面函数，在函数代码开发页面，编辑省市区控件的赋值函数，如下图所示：

![image](https://user-images.githubusercontent.com/79617492/227878061-5371909d-7131-4c0f-9fe4-c2f276687f48.png)

##### 图16-12 编辑省市区控件的赋值函数

e）选中省市区选择控件，单击右侧属性栏绑定动作 > 点击完成按钮时。

![image](https://user-images.githubusercontent.com/79617492/227878097-c0a3cbde-0338-41f6-89e8-3854ca7357bd.png)

##### 图16-13 单击点击完成按钮时

f）在绑定动作页面，选择内置动作 > 数据处理 > 新增数据处理，左侧绑定页面变量“text”，右侧绑定省市区选择控件值变量。

![image](https://user-images.githubusercontent.com/79617492/227878126-011d63b9-9f84-4070-b2bc-30ffedc113b8.png)

##### 图16-14 绑定变量

g）再次单击新增数据处理，左侧绑定页面变量“display”，右侧手动输入“false”。

##### 说明：当选择完省市区后，单击确定按钮，省市区控件隐藏。

![image](https://user-images.githubusercontent.com/79617492/227878158-11af438d-1d76-4fcb-93ef-083f0e7db9a7.png)

##### 图16-15 单击新增数据处理

h）再次单击右侧属性栏绑定动作 > 点击完成按钮时。

![image](https://user-images.githubusercontent.com/79617492/227878193-fffbd6d7-d969-490f-8cf7-92d5b5245d8d.png)

##### 图16-16 单击点击完成按钮时

i）在绑定动作页面，选择内置动作 > 函数处理 > 新增函数处理，绑定页面函数ssq()。

![image](https://user-images.githubusercontent.com/79617492/227878320-8bcd22d2-4d9d-4d87-bc25-4936b2d6a6b1.png)

##### 图16-17 选择新增函数处理

j）单击右侧属性栏绑定动作 > 点击取消按钮时。在绑定动作页面，选择内置动作 > 数据处理 > 新增数据处理，左侧绑定页面变量“display”，右侧手动输入“false”。

##### 说明：当单击省市区选择控件取消按钮时，控件隐藏。

![image](https://user-images.githubusercontent.com/79617492/227878368-c4ab25f5-a349-4b7b-ae99-a112dfb059e1.png)

##### 图16-18 绑定变量

k）选中输入框控件，单击右侧属性栏绑定动作 > 点击完成按钮时。在绑定动作页面，选择内置动作 > 数据处理 > 新增数据处理，左侧绑定页面变量“display”，右侧手动输入“true”。

##### 说明：当单击输入框控件时，省市区控件显示。

![image](https://user-images.githubusercontent.com/79617492/227878442-f2b80fd8-39f6-4283-aa5d-d94a9ac1f9ed.png)

##### 图16-19 绑定变量

l）单击预览，在预览页面，单击输入框，弹出省市区选择控件，选择需要的城市，单击确定后选择的省市区值显示在输入框内。

![image](https://user-images.githubusercontent.com/79617492/227878481-50e8268a-46b8-4f2e-b4cb-06053ad57d9a.png)

##### 图16-20 单击预览

#### 4.6.16.2.2 动态获取省市区数据

前提条件：分别准备可以返回省市区控件数据的后端接口，数据格式如下：

![image](https://user-images.githubusercontent.com/79617492/227878508-cb77f0ca-5576-426c-807d-8588303784fc.png)

##### 图16-21 数据格式1

![image](https://user-images.githubusercontent.com/79617492/227878536-351e965d-5146-47ee-a0cf-7e525e530319.png)

##### 图16-22 数据格式2

![image](https://user-images.githubusercontent.com/79617492/227878557-4c29db5e-dc3f-4670-a7ef-a3be3f8ee1a7.png)

##### 图16-23 数据格式3

a）在页面开发界面，重复本文案例一的 “步骤 a）~ 步骤l）”。

##### 说明：动态获取省市区数据，只需在本文案例一操作的基础上，把控件数据源换成后端接口数据源即可。

b）选中省市区控件，在右侧属性栏分别将对应的页面变量绑定在省市区数据源中，如下图16-24至图16-26所示：

![image](https://user-images.githubusercontent.com/79617492/227878649-3d50ddff-aa51-471b-902e-4b78428dc20e.png)

##### 图16-24 省份数据源

![image](https://user-images.githubusercontent.com/79617492/227878688-746709ce-502a-4952-8032-699508338f49.png)

##### 图16-25 城市数据源

![image](https://user-images.githubusercontent.com/79617492/227878711-d209d2cd-3962-41c7-ba8d-e0048ccfa110.png)

##### 图16-26 区县数据源

c）单击右侧属性栏页面配置 > 绑定动作 > 页面加载前事件。

##### 说明：此处 “步骤c）到步骤e）” 以加载省份数据为例，城市与区县数据加载与省份数据加载操作方法一致，分别赋值给变量city和area。

![image](https://user-images.githubusercontent.com/79617492/227878733-52a3d310-9f7a-468e-8205-937620fd1f84.png)

##### 图16-27 单击页面加载前事件

d）在绑定动作页面选择对应的项目和接口，填写需要的参数。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/16-28.png)

##### 图16-28 填写需要的参数

e）单击下方响应成功处理的新增处理动作，填写判断条件，执行动作选择数据处理，左侧绑定页面变量”province“，右侧绑定后端接口响应数据“data”。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/16-29.png)

##### 图16-29 绑定变量

f）单击预览，在预览页面，查看动态获取省市区数据效果。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/16-30.png)

##### 图16-30 单击预览
