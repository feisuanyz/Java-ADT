### 4. 控件使用指南

#### 4.6 高级控件

#### 4.6.2 下拉树选择

下拉树选择组件是一个类似于下拉选择框的选择组件，可选择的数据结构是一个层级结构。可使用的场景为分类目录等。

#### 4.6.2.1 基本属性

a）组件描述：可输入对组件的描述，字符限制在200字符以内。

![image](https://user-images.githubusercontent.com/79617492/223967798-291bd629-ad8f-412d-a3cb-c9ff2b4ee597.png)

##### 图2-1 组件描述

b）标题：可输入下拉选择树组件标题，字符限制在20字符以内。

![image](https://user-images.githubusercontent.com/79617492/223967842-60dd5405-9c84-43ea-a425-35c69837ceba.png)

##### 图2-2 标题

c）选择框提示内容：当选择框未选择时的显示文案，默认为“请选择”。

![image](https://user-images.githubusercontent.com/79617492/223967893-910dce01-45f3-4b4f-be3f-2e49eaa6ca59.png)

##### 图2-3 选择框提示内容

d）展示清除按钮：开关开启后，选择框最右方展示“x”，点击可清除选择内容。

![image](https://user-images.githubusercontent.com/79617492/223967941-02644a1d-c3ac-4f34-aa74-5e420f76228b.png)

##### 图2-4 展示清除按钮

e）下拉框和选择框同宽：开关开启后，选择项的宽度与选择框相同。

![image](https://user-images.githubusercontent.com/79617492/223967984-54a9e64d-e3ef-489a-a402-289dfdace6b8.png)

##### 图2-5 下拉框和选择框同宽

f）展示搜索：开关开启后，将在下拉框中展示搜索栏。

![image](https://user-images.githubusercontent.com/79617492/223968067-8e411a7a-20d6-418b-b977-1c36fd79a28f.png)

##### 图2-6 展示搜索

g）是否禁用：开启后控件无法使用。

![image](https://user-images.githubusercontent.com/79617492/223968102-10addd38-256a-4723-a39a-ae0a5fb48cc3.png)

##### 图2-7 是否禁用

h）是否非空：开启后，选择框为必填项，当选择框为空时，弹出提示。

![image](https://user-images.githubusercontent.com/79617492/223968140-bd65cb41-547d-442d-a0dc-d4ac2f9f931b.png)

##### 图2-8 是否非空

i）标题位置：可以将标题的位置切换为上方或者左边。

![image](https://user-images.githubusercontent.com/79617492/223968168-979e116e-28b8-44dd-b002-7d779983e2b1.png)

##### 图2-9 标题位置

j）尺寸：可以切换下拉树控件的尺寸。

![image](https://user-images.githubusercontent.com/79617492/223968251-03eb4d5a-18c0-4811-83c0-c7de3b67df83.png)

##### 图2-10 尺寸

k）支持多选：开关开启后，可以同时选择多个。

![image](https://user-images.githubusercontent.com/79617492/223968279-19cb12f3-a232-46c0-8c40-e76edcac0920.png)

##### 图2-11 支持多选

l）搜索框提示内容：当搜索框未输入时的显示文案，默认为“请输入搜索关键字”。

![image](https://user-images.githubusercontent.com/79617492/223968326-498842dc-1f2c-4cdd-92cc-306093586baf.png)

##### 图2-12 搜索框提示内容

m）数据格式：提供平级数据和层级数据格式选择，默认为层级数据。


```
字段说明：

title：标题

key：值

disabled：是否失效

disableCheckBox：禁止多选

parentKey：父级ID

children：子集元素
```

平级数据格式：

![image](https://user-images.githubusercontent.com/79617492/223968377-2ef1b001-add9-4108-a4b9-5782315fe13e.png)

##### 图2-13 平级数据格式

层级数据格式：

![image](https://user-images.githubusercontent.com/79617492/223968425-194af009-11c4-4623-afc7-b0fa7f310f74.png)

##### 图2-14 层级数据格式

n）选中值：可设置默认的选中值，格式为“key”字段的数据格式，例：["0-0-1"]。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/2-15.png)

##### 图2-15 选中值

o）数据源：可按照固定格式手动输入或绑定变量来设置树组件的数据源，格式如下：

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/2-16.png)

##### 图2-16 数据源

p）数据映射：可设置title、key的等数据映射字段，需与绑定接口的数据字段保持一致。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/2-17.png)

##### 图2-17 数据映射

q）展开树节点：开关打开后，展开选择框时，默认展开所有树节点。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/2-18.png)

##### 图2-18 展开树节点

r）绑定事件：支持绑定控件的当选中值变化时、当搜索框值变化时、当展开节点时、当节点被选中时的动作，当符合条件时，会触发相应动作。详情见《SoFlu（前端）全自动开发平台教程第3.3.16节至第3.3.20节》绑定动作部分。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/2-19.png)

##### 图2-19 绑定事件

#### 4.6.2.2 操作案例

#### 4.6.2.2.1 动态获取下拉树选择数据

前提条件：准备一个可返回树组件数据的后端接口，返回数据格式如下：

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/2-20.png)

##### 图2-20 前提条件

a）在左侧控件库，拖入一个下拉选择树组件到右侧画布。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/2-21.png)

##### 图2-21 拖入一个下拉选择树组件

b）定义一个页面变量treeText用于接收下拉树选择数据。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/2-22.png)

##### 图2-22 定义一个页面变量treeText

c）切换到页面配置，点击绑定动作 > 页面加载前事件。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/2-23.png)

##### 图2-23 点击页面加载前事件

d）在绑定动作页面，选择对应的项目以及接口。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/2-24.png)

##### 图2-24 选择对应的项目以及接口

e）单击新增处理动作，新增响应成功处理。将接口响应数据中的data赋值给treeText变量，然后单击确定。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/2-25.png)

##### 图2-25 单击新增处理动作

f）回到属性配置页，单击数据源后的绑定变量按钮，选择treeText变量，然后单击确定。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/2-26.png)

##### 图2-26 单击数据源后的绑定变量按钮

g）预览页面，单击输入框后展开下拉框进行选择。

![输入图片说明](../../../../images/%20SoFlu%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89%E5%85%A8%E8%87%AA%E5%8A%A8%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0%E6%95%99%E7%A8%8B/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202023.01.10/4.%20%E6%8E%A7%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/6.%20%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6/2-27.png)

##### 图2-27 预览页面
