### 5. 完整案例专题

#### 5.2 客户意见反馈

本节为您介绍客户意见反馈功能的实现。

#### 5.2.1 功能描述

客户意见反馈功能的实现具体包含以下子功能：

a）提交客户意见反馈

b）客户反馈意见后台管理

c）添加回访记录

d）查询回访记录

![image](https://user-images.githubusercontent.com/79617492/228446749-70150b05-f2cc-45e2-b6be-89a557dd2c1c.png)

##### 图2-1 客户意见反馈子功能

##### 说明：通过在【客户意见反馈页面】填写意见反馈信息，单击“提交反馈”或者“后台”即可进入【后台管理页面】；在【后台管理页面】，可对每一条反馈意见进行回访操作，进入【添加回访记录页面】；在【添加回访记录页面】填写该条反馈的回访记录内容，单击“提交”，再次进入【后台管理页面】，便可以看到对应反馈意见记录的回访状态字段由未回访变化为已回访；同时在【后台管理页面】单击“查看回访记录”可进入【查询回访记录页面】查看所有的回访记录。

#### 5.2.2 步骤引导

a）后端接口准备

b）关联（后端）全自动开发平台项目

c）页面构建、数据绑定

d）页面预览、功能测试

#### 5.2.2.1 后端接口准备

在（后端）全自动开发平台准备前端页面需调用到的5个接口：

![image](https://user-images.githubusercontent.com/79617492/228446791-b4c5a23c-e2ec-4bb7-bb8a-3ef561b10f23.png)

##### 图2-2 需调用的5个接口

a）客户意见反馈录入接口

用于新增客户意见反馈信息。

![image](https://user-images.githubusercontent.com/79617492/228446818-9e4a87cf-22e7-4fff-b8aa-20e28b2d0d1b.png)

##### 图2-3 客户意见反馈录入接口流程图

b）查询客户反馈意见列表接口

用于查询客户反馈意见数据，显示在【后台管理页面】。

![image](https://user-images.githubusercontent.com/79617492/228446837-33c21a3e-c87b-45a0-978b-f89859b6c7fe.png)

##### 图2-4 查询客户反馈意见列表接口流程图

c）查询字典表数据接口

用于根据参数opinionType（意见类型）和satisfaction（满意度）查询对应的字典表数据，作为选项数据返回在【用户注册页面】中“意见类型”多选框及“满意度”单选框。

![image](https://user-images.githubusercontent.com/79617492/228446861-3ebebd20-0230-4a42-a30b-5e3ebbf01b50.png)

##### 图2-5 查询字典表数据接口流程图

![image](https://user-images.githubusercontent.com/79617492/228446879-8f5e50e7-45ac-4713-a960-03047440b129.png)

##### 图2-6 数据返回效果 

d）新增回访记录接口

用于添加回访记录。

![image](https://user-images.githubusercontent.com/79617492/228446919-8c12cde6-20b2-4740-b8a5-550af5d07772.png)

##### 图2-7 新增回访记录接口流程图

e）查询回访记录接口

用于查询回访记录。

![image](https://user-images.githubusercontent.com/79617492/228446942-23d1d842-2553-4f07-a9d0-c17c114f9351.png)

##### 图2-8 查询回访记录接口流程图

#### 5.2.2.2 关联（后端）全自动开发平台项目

##### 前提条件：您已完成创建前端应用项目、创建页面等基本操作。

由于在（前端）全自动开发平台创建的项目会同步显示在（后端）全自动开发平台，若后端接口在相同项目名下开发，在选择关联后端项目时，选择同名项目即可，如下图所示：

![image](https://user-images.githubusercontent.com/79617492/228446968-e0db5d16-f13e-450d-8a9a-103cf9375dd8.png)

##### 图2-9 新增后端项目

#### 5.2.2.3 页面构建、数据绑定

客户意见反馈功能包含【客户意见反馈页面】、【后台管理页面】、【添加回访记录页面】和【查询回访记录页面】四个页面的构建，如下图所示，图中的连接线代表页面间的跳转关系。

![image](https://user-images.githubusercontent.com/79617492/228447099-60b0f1a6-ef1b-4d3d-95f0-44f30df94ecb.png)

##### 图2-10 客户意见反馈功能

a）客户意见反馈页面

a1）页面构建

![image](https://user-images.githubusercontent.com/79617492/228448549-cd438ec5-c83a-41fd-aae2-de913dc0dd21.png)

##### 图2-11 页面构建

a2）数据绑定

a2-1）为页面绑定：当页面加载前，两次调用查询字典表数据接口，获取选项数据返回在【用户注册页面】中“意见类型”多选框及“满意度”单选框。

说明：调用接口前需设置4个页面变量，如下图“为页面绑定2”所示，前两个页面变量opinionType、satisfaction为传入的查询参数，后两个opinionTypeName、satisfactionName为选项值的接收参数。

![image](https://user-images.githubusercontent.com/79617492/228448574-0674e3ab-71ae-44ed-a035-d53c022b6daf.png)

##### 图2-12 为页面绑定1

![image](https://user-images.githubusercontent.com/79617492/228448603-4ecb167b-631f-4841-9c2c-ae57df43f847.png)

##### 图2-13 为页面绑定2

![image](https://user-images.githubusercontent.com/79617492/228448629-09345688-5c4a-4a49-b65e-84ae4aa8c189.png)

##### 图2-14 为页面绑定3

![image](https://user-images.githubusercontent.com/79617492/228449056-51772ce3-0bc9-4f00-b763-41bc35d3a676.png)

##### 图2-15 为页面绑定4

![image](https://user-images.githubusercontent.com/79617492/228449090-0fad47cf-a069-4f72-9170-df5a0987de49.png)

##### 图2-16 为页面绑定5

![image](https://user-images.githubusercontent.com/79617492/228449121-ceda2daa-afc8-4fd2-b7d2-8da46d51b6a9.png)

##### 图2-17 为页面绑定6

a2-2）为后台按钮控件绑定：当点击时，跳转至【后台管理页面】。

![image](https://user-images.githubusercontent.com/79617492/228449152-1bfc7ff2-062a-4c7c-bce8-0e496b034f9f.png)

##### 图2-18 为后台按钮控件绑定1

![image](https://user-images.githubusercontent.com/79617492/228449193-5844da22-53cd-4009-b3a3-1b8e65aba283.png)

##### 图2-19 为后台按钮控件绑定2

a2-3）为提交反馈按钮控件绑定：当点击时，调用客户意见反馈录入接口，传入选项卡中的四个填写参数，直接选择控件即可；同时跳转到【后台管理页面】，如下图所示：

![image](https://user-images.githubusercontent.com/79617492/228449223-b1897f21-72de-48d1-9044-9fb09e0bc8b5.png)

##### 图2-20 为提交反馈按钮控件绑定1

![image](https://user-images.githubusercontent.com/79617492/228449267-8b5d46c1-c35c-4e78-bf7d-f937632f79df.png)

##### 图2-21 为提交反馈按钮控件绑定2

![image](https://user-images.githubusercontent.com/79617492/228449313-96add63e-e455-44d3-8bf6-2d5b98f9a274.png)

##### 图2-22 为提交反馈按钮控件绑定3

![image](https://user-images.githubusercontent.com/79617492/228449378-5f89c5f2-9ce9-4a01-947c-8107cd3687d1.png)

##### 图2-23 为提交反馈按钮控件绑定4

b）后台管理页面

b1）页面构建

![image](https://user-images.githubusercontent.com/79617492/228449404-57c7297b-320b-4a67-9242-3d94fbca67f7.png)

##### 图2-24 页面构建

b2）数据绑定

b2-1）为表格控件绑定：调用查询客户反馈意见列表接口，将所有的客户反馈意见信息展示在【后台管理页面】。

![image](https://user-images.githubusercontent.com/79617492/228449418-429c1e5a-ec1c-4f2f-8d68-fc1e7ed533c2.png)

##### 图2-25 为表格控件绑定1

![image](https://user-images.githubusercontent.com/79617492/228453758-b2b48ee7-7679-41d8-9cdc-00f9c0fe0bf4.png)

##### 图2-26 为表格控件绑定2

b2-2）为表格控件中的顶部操作-查询回访记录绑定：当点击时，跳转至【查询回访记录页面】。

![image](https://user-images.githubusercontent.com/79617492/228453781-b96a6ee1-9b52-4f02-bf16-21bf1c609e05.png)

##### 图2-27 为顶部操作查询回访记录绑定1

![image](https://user-images.githubusercontent.com/79617492/228453806-ad0b2e80-4197-4294-b2f4-d9595f5eaacf.png)

##### 图2-28 为顶部操作查询回访记录绑定2

![image](https://user-images.githubusercontent.com/79617492/228453821-ed705031-ceab-4ed3-afcf-d01e1570280e.png)

##### 图2-29 为顶部操作查询回访记录绑定3

![image](https://user-images.githubusercontent.com/79617492/228453842-1ca35589-0ecb-45a8-927d-8b9fbe3b4d09.png)

##### 图2-30 为顶部操作查询回访记录绑定4

b2-3）为操作列-回访绑定：当点击时，跳转至【添加回访记录页面】，同时将表格当前行变量中的反馈人联系方式传递到【添加回访记录页面】，用参数contactWay表示，如下图“为操作列回访绑定4”、图“为操作列回访绑定5”所示：

##### 说明：此处传递反馈人联系方式，用于在【添加回访记录页面】同时将反馈人联系方式和回访记录内容添加至回访记录列表。

![image](https://user-images.githubusercontent.com/79617492/228453871-712a7051-fd65-4330-90e4-3af9b7dbb70f.png)

##### 图2-31 为顶部操作查询回访记录绑定1

![image](https://user-images.githubusercontent.com/79617492/228453900-f8a4eebe-4a18-4e50-97d0-31f79b2f71d8.png)

##### 图2-32 为顶部操作查询回访记录绑定2

![image](https://user-images.githubusercontent.com/79617492/228466457-f0fd64ef-e487-41ad-b43c-e99a15830aa9.png)

##### 图2-33 为顶部操作查询回访记录绑定3

![image](https://user-images.githubusercontent.com/79617492/228466487-7cf21997-58a4-4f0d-bf6a-85b69fb0164d.png)

##### 图2-34 为顶部操作查询回访记录绑定4

![image](https://user-images.githubusercontent.com/79617492/228466518-50bd3dc1-63d4-4116-bf92-8abd0242efee.png)

##### 图2-35 为顶部操作查询回访记录绑定5

c）添加回访记录页面

c1）页面构建

![image](https://user-images.githubusercontent.com/79617492/228466560-3cb00a7e-1d39-457a-955e-8224450795d5.png)

##### 图2-36 页面构建

c2）数据绑定

c2-1）为提交按钮控件绑定：当点击时，调用新增回访记录接口，传入联系方式和回访记录内容；同时跳转至【后台管理页面】。

##### 注意：

##### c2-1a）传入联系方式之前需要先在【添加回访记录页面】设置一个同名参数变量contactWay，用于接收【后台管理页面】在点击回访按钮传递过来的反馈人联系方式，如下图“为提交按钮控件绑定1”所示。

##### c2-1b)新增回访记录接口中，不仅会新增一条回访记录，还会修改对应反馈意见的回访状态，将未回访修改为已回访，具体可见新增回访记录接口的流程图。

![image](https://user-images.githubusercontent.com/79617492/228466611-4efd88b5-cea0-412b-b755-1825e2287561.png)

##### 图2-37 为提交按钮控件绑定1

![image](https://user-images.githubusercontent.com/79617492/228798553-9ba6507f-e00f-4643-84c7-6183b029e065.png)

##### 图2-38 为提交按钮控件绑定2

![image](https://user-images.githubusercontent.com/79617492/228798572-957923d1-6374-42c7-bdc0-a410436b6cc3.png)

##### 图2-39 为提交按钮控件绑定3

![image](https://user-images.githubusercontent.com/79617492/228798590-2420ecaf-01d6-475a-ade3-bdb2f2f18d25.png)

##### 图2-40 为提交按钮控件绑定4

![image](https://user-images.githubusercontent.com/79617492/228798619-ade4a28b-2aa5-47bc-a8cc-0c7fb66b86a5.png)

##### 图2-41 为提交按钮控件绑定5

c2-2）为返回按钮控件绑定：当点击时，跳转至【后台管理页面】。

![image](https://user-images.githubusercontent.com/79617492/229434953-86c6891c-ff2c-4109-be02-a65dcf67230c.png)

##### 图2-42 为返回按钮控件绑定1

![image](https://user-images.githubusercontent.com/79617492/229434987-649d9f41-e5a7-46ba-b08c-9b781cc85569.png)

##### 图2-43 为返回按钮控件绑定2

d）查询回访记录页面

d1）页面构建

![image](https://user-images.githubusercontent.com/79617492/229435054-9711bca4-1dd6-4b08-9e72-14317a140bd9.png)

##### 图2-44 页面构建

d2）数据绑定

d2-1）为表格控件绑定：通过调用查询回访记录接口获取数据，显示在【查询回访记录页面】。

![image](https://user-images.githubusercontent.com/79617492/229435083-4c57dfe2-21a3-40c0-a9c2-7d49e6b93646.png)

##### 图2-45 为表格控件绑定1

![image](https://user-images.githubusercontent.com/79617492/229435100-0b354422-99aa-45fb-883c-49d0a7d01adb.png)

##### 图2-46 为表格控件绑定2

e）页面预览、功能测试

e1）上述所有操作完成后，在【客户意见反馈页面】所在页面开发界面上方，单击“预览”选项，进行页面预览。

![image](https://user-images.githubusercontent.com/79617492/229435135-fbfd813c-f526-4280-a6e0-f57d2c671285.png)

##### 图2-47 单击“预览”选项

e2）预览加载完成后，系统将自动弹出浏览器窗口展示页面，此时您可以输入客户意见反馈信息，并进行相关操作，检测是否可以正常运行。

##### 说明：在浏览器按F12键，即可查看手机端效果。

提交反馈意见：

![image](https://user-images.githubusercontent.com/79617492/229435166-5d651c52-3c56-4431-9354-aec9152bb964.png)

##### 图2-48 提交反馈意见

查看反馈意见列表：

![image](https://user-images.githubusercontent.com/79617492/229435199-92b48619-0448-41cb-8dbc-15c8eafdb6a7.png)

##### 图2-49 查看反馈意见列表

添加回访记录：

![image](https://user-images.githubusercontent.com/79617492/229435218-3244d2b7-f399-49e2-9fd7-2c8808e8aeea.png)

##### 图2-50 添加回访记录1

![image](https://user-images.githubusercontent.com/79617492/229435282-72c40e66-96b5-41ba-a4dd-5bb5c41dce3e.png)

##### 图2-51 添加回访记录2

修改回访状态：

![image](https://user-images.githubusercontent.com/79617492/229435296-78a661bb-2109-494b-82f0-9d2883aa89ea.png)

##### 图2-52 修改回访状态

查看回访记录列表：

![image](https://user-images.githubusercontent.com/79617492/229435317-99374666-b6eb-4a4a-8501-a18c6d9c020c.png)

##### 图2-53 查看回访记录列表1

![image](https://user-images.githubusercontent.com/79617492/229435335-e9abdab1-03c7-4353-b4c0-d206861c966f.png)

##### 图2-54 查看回访记录列表2
