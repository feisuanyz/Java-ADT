### 5. 完整案例专题

#### 5.3 春节疫情防控

为了加强春节后企业复工安全及环保，做好新冠疫情防控工作，全面提升企业安全和环保系数，企业急需开发春节疫情防控功能；员工提交报务信息后，程序便可自动统计从中高风险地区返回的员工数量及员工信息。由于时间紧、任务重，使用飞算SoFlu软件机器人进行开发，可以大大地提升开发效率，保证及时开发出功能，本节为您介绍使用飞算SoFlu软件机器人开发该功能的具体操作过程。

#### 5.3.1 功能描述

春节疫情防控功能的实现具体包含以下子功能：

a）企业员工提交报务信息

b）进行风险地统计

c）查询所有申报信息

![image](https://user-images.githubusercontent.com/79617492/229449082-eb6340dd-5a9c-4c53-8a90-f9500cc8664b.png)

##### 图3-1 春节疫情防控功能

##### 说明：企业员工在【人员报务信息页面】填写人员报务信息之后，单击“申报”即可进入【风险地统计页面】，该页面统计了中高风险地区的人员数量及相关人员的信息，单击“查看全部”即可进入【申报信息查询页面】查看所有员工的申报信息，并按条件进行查询。

#### 5.3.2 步骤引导

#### 5.3.2.1 后端接口准备

在（后端）全自动开发平台准备前端页面需调用到的5个接口：

![image](https://user-images.githubusercontent.com/79617492/229449116-aa8d2165-0168-4fe3-89b9-4225a9f99b73.png)

##### 图3-2 需调用到的5个接口

a）查询字典表接口流程图

用于获取申报类型、申报方式、证件类型、性别、国籍、是否离开公司所在地、返回地风险级别及所属部门的选项数据。

![image](https://user-images.githubusercontent.com/79617492/229449156-78448aab-91e7-4d25-8137-b1f2441d687c.png)

##### 图3-3 查询字典表接口流程图

b）风险地统计查询接口流程图

用于统计中、高风险地数量以及中高风险地合计数量。

![image](https://user-images.githubusercontent.com/79617492/229449182-dd6a3a30-e823-448c-a37c-94afc4b60f64.png)

##### 图3-4 风险地统计查询接口流程图

c）查询申报信息接口流程图

用于查询所有员工的申报信息。

![image](https://user-images.githubusercontent.com/79617492/229449210-c1277b72-9594-454d-a367-875ee28072fb.png)

##### 图3-5 查询申报信息接口流程图

d）查询省市区信息接口流程图

用于获取省市区信息，作为【人员报务信息】页面中“所在区域”的选项数据。

![image](https://user-images.githubusercontent.com/79617492/229452384-a7574adb-502c-4be3-8b80-10605db42f04.png)

##### 图3-6 查询省市区信息接口流程图

e）新增人员报务信息接口

用于新增人员报务信息。

![image](https://user-images.githubusercontent.com/79617492/229452483-8ef33e2a-8f7b-47d2-9a5e-e21a89d56eb8.png)

##### 图3-7 新增人员报务信息接口流程图

#### 5.3.2.2 关联（后端）全自动开发平台项目

##### 前提条件： 您已完成创建前端应用项目、创建页面等基本操作。

为展示和前两个案例的不同，本案例选择关联第三方项目的方式来关联后端项目，所关联的第三方项目仍由（后端）全自动开发平台进行开发。在关联第三方项目时，填写好对应服务器信息即可，如下图所示。

![image](https://user-images.githubusercontent.com/79617492/229456273-5777b962-7313-466a-a7ed-49ee4e25dfc6.png)

##### 图3-8 填写对应服务器信息

#### 5.3.2.3 页面构建、数据绑定

疫情防控功能包含【人员报务信息页面】、【风险地统计页面】和【申报信息查询页面】三个页面的构建，如下图所示。

![image](https://user-images.githubusercontent.com/79617492/229456295-cb076150-6290-4db2-acca-535c6c753ee4.png)

##### 图3-9 疫情防控功能

a）人员报务信息页面

a1）页面构建

通过点击页面开发界面中大纲树选项，即可查看该页面使用到的所有控件，点击控件右侧的眼睛按钮，可显示或隐藏对应控件以展示不同的页面效果；控件的具体配置可根据实际需求进行自定义配置，若不清楚如何配置控件，可点击属性栏文档选项查看对应控件的帮助文档。

##### 说明：您可根据功能开发的实际情况选择面向电脑端或手机端进行设计，本案例选择手机端，如下图所示：

![image](https://user-images.githubusercontent.com/79617492/229456326-d5d47e1b-4529-43e9-baf4-e00b37fa4605.png)

##### 图3-10 大纲树1

![image](https://user-images.githubusercontent.com/79617492/229457801-223f696d-7af1-4bac-95f2-97210add3da2.png)

##### 图3-11 大纲树2

a2）数据绑定

a2-1）设置页面变量

点击页面开发界面上方工具栏“变量设置”选项，设置页面变量。

##### 说明：由于申报类型、申报方式、证件类型、性别、国籍、是否离开公司所在地、返回地风险级别、所属部门的选项数据需通过调用查询字典表接口获取，返回地的选项数据需通过调用查询省市区信息接口获取，所以需要设置页面变量来接收调用接口获取的数据。

![image](https://user-images.githubusercontent.com/79617492/229457835-afa344bf-c653-4b52-acd5-578273d18ee7.png)

##### 图3-12 设置页面变量

a2-2）绑定页面加载前事件

点击“属性栏 > 页面配置”绑定页面加载前事件，分别调用查询字典表数据接口和查询省市区信息接口获取选项数据，使用页面变量接收，如下图所示。

##### 说明：接口地址填写（后端）全自动开发平台中对应接口基本信息下的接口路径即可。

![image](https://user-images.githubusercontent.com/79617492/229457925-e981cc2b-56b6-48cb-8ced-ffb1f593b6c3.png)

##### 图3-13 执行绑定动作1

![image](https://user-images.githubusercontent.com/79617492/229458227-e9a47c3c-52d8-479e-abc6-23f199b42d07.png)

##### 图3-14 执行绑定动作2

a2-3）为控件绑定页面对应的页面变量，以下选择申报类型下拉选择框为样例，其他控件同理

选中“申报类型”下拉选项框，点击属性栏下“属性 > 选项”旁的链接按钮，进入变量绑定页面，选择“页面变量 > 申报类型名称”，单击“确定”即可。

![image](https://user-images.githubusercontent.com/79617492/229458254-b39f26eb-b993-4966-b119-86b999057c41.png)

##### 图3-15 选中申报类型

![image](https://user-images.githubusercontent.com/79617492/229458583-7a17434c-591a-4f3b-8f4d-11f87b7e13b2.png)

##### 图3-16 变量绑定

a2-4）为申报按钮绑定点击事件

选中申报按钮，在属性栏“属性 > 动作面板”下进行两次绑定动作操作，分别用于调用新增人员报务信息接口和跳转至【风险地统计页面】，如下图所示。

![image](https://user-images.githubusercontent.com/79617492/229458612-00b59a3a-6300-4fe3-88f4-edba57802bbb.png)

##### 图3-17 执行绑定动作1

![image](https://user-images.githubusercontent.com/79617492/229461474-6e01475e-a12b-44fa-a022-aa692158ad01.png)

##### 图3-18 执行绑定动作2

b）风险地统计页面

b1）页面构建

本案例中【风险地统计页面】通过多次使用容器、文本控件以及表格控件进行页面构建，您也可以根据实际需求进行自定义设计。

![image](https://user-images.githubusercontent.com/79617492/229461486-a7d062e5-3a2b-4e6a-9bd4-f719e2c0e6a2.png)

##### 图3-19 页面构建

b2）数据绑定

b2-1）设置页面变量

下图中三个文本控件均需通过调用风险地统计查询接口来获取数据，所以需要设置页面变量来接收数据，点击页面上方“变量设置 > 页面变量”进行设置即可。

![image](https://user-images.githubusercontent.com/79617492/229461527-f4820230-9263-418d-9e81-b9aa99e68186.png)

##### 图3-20 文本控件

![image](https://user-images.githubusercontent.com/79617492/229461559-65266ebd-9fed-486b-b22d-3e6343132414.png)

##### 图3-21 变量设置

b2-2）为三个文本控件绑定页面变量，以下选择中风险区域数量作为样例，其余两个文本控件同理

选中需绑定页面变量的文本控件，点击属性栏“属性 > 内容”旁的链接按钮，选择页面变量中风险数量即可。

![image](https://user-images.githubusercontent.com/79617492/229461595-02f1c64e-4b29-4c40-89f8-563a5ddf599d.png)

##### 图3-22 点击链接按钮

![image](https://user-images.githubusercontent.com/79617492/229461622-9012aa95-23b1-48f3-b621-f429c3bd0854.png)

##### 图3-23 变量绑定

b3）为表格控件绑定动作，调用风险地统计查询接口，显示人员报务信息并进行风险地数量统计

选中表格控件，点击属性栏下“属性 > 动作面板”绑定动作按钮，进行获取数据绑定动作操作，如下图所示，其中“数据处理”即为将调用接口得到的数据赋值给三个页面变量。

![image](https://user-images.githubusercontent.com/79617492/229461656-bb00e4d4-7aef-46ad-a4d7-ea5814e81621.png)

##### 图3-24 执行绑定动作

b4）为表格控件中查询全部选项绑定动作，跳转至【申报信息查询页面】

选中表格控件，点击属性栏“属性 > 顶部操作”选项，配置“查看全部”操作条，并为该操作条绑定动作，跳转至【申报信息查询页面】。

![image](https://user-images.githubusercontent.com/79617492/229461689-f09d353d-f9fc-4d65-9e07-0e99bba47a15.png)

##### 图3-25 配置“查看全部”操作条

![image](https://user-images.githubusercontent.com/79617492/229461737-c980489e-d25f-4d7e-860b-1efaae2f7c7e.png)

##### 图3-26 执行绑定动作

c）申报信息查询页面

c1）页面构建

【申报信息查询页面】仅使用了一个表格组件，主要用于显示所有的人员申报信息，并按条件查询，表格中的字段需自行设置。

![image](https://user-images.githubusercontent.com/79617492/229461776-62d18d8f-521b-4d77-94f7-4df614e9e2aa.png)

##### 图3-27 页面构建

c2）数据绑定

c2-1）设置页面变量风险级别，用于接收风险级别的选项数据。

c2-2）自定义筛选项配置，并为筛选项“风险级别”绑定页面变量。

c2-3）绑定页面加载前事件，调用查询字典表接口，获取风险级别的选项数据，并赋值给页面变量风险级别。

c2-4）为表格控件绑定事件，调用查询申报信息接口，将所有人员申报信息显示在当前页面。

c2-5）为顶部操作条“返回”绑定事件，跳转至【风险地统计页面】。

##### 说明：由于以上操作均可在前两个页面中数据绑定操作中找到参考，此处不再赘述。

#### 5.3.2.4 页面预览、功能测试

a）上述所有操作完成后，在【人员报务信息页面】设计界面上方，单击“预览”选项，进行页面预览和功能测试。

![image](https://user-images.githubusercontent.com/79617492/229461822-bf6914e0-cba6-4300-84cf-451f9171103e.png)

##### 图3-28 单击“预览”选项

b）预览加载完成后，系统将自动弹出浏览器窗口展示页面，此时您可以输入人员报务信息，并进行相关操作，检测是否可以正常运行。

![image](https://user-images.githubusercontent.com/79617492/229461860-76616a12-b3fe-4768-9d8d-3aba4e3cd1f6.png)

##### 图3-29 预览效果1

![image](https://user-images.githubusercontent.com/79617492/229461915-46efcdee-6884-44b8-a8ac-9fd01b3bae4f.png)

##### 图3-30 预览效果2
