### 2. 平台实践

#### 2.3 春节疫情防控

为了加强春节后企业复工安全及环保，做好新冠疫情防控工作，全面提升企业安全和环保系数，企业急需开发春节疫情防控功能；员工提交报务信息后，程序便可自动统计从中高风险地区返回的员工数量及员工信息。由于时间紧、任务重，使用飞算SoFlu软件机器人进行开发，可以大大地提升开发效率，保证及时开发出功能，本节为您介绍使用飞算SoFlu软件机器人开发该功能的具体操作过程。

##### 2.3.1 功能描述

春节疫情防控功能的实现具体包含以下子功能：

a）企业员工提交报务信息

b）进行风险地统计

c）查询所有申报信息

![image](https://user-images.githubusercontent.com/79617492/182995691-33c05aec-006b-4815-b50b-58b5d95b5958.png)

##### 图3-1 春节疫情防控功能

##### 说明：企业员工在【人员报务信息页面】填写人员报务信息之后，单击“申报”即可进入【风险地统计页面】，该页面统计了中高风险地区的人员数量及相关人员的信息，单击“查看全部”即可进入【申报信息查询页面】查看所有员工的申报信息，并按条件进行查询。

##### 2.3.2 后端接口准备

在（后端）全自动开发平台准备前端页面需调用到的5个接口：

![image](https://user-images.githubusercontent.com/79617492/182995711-9842db7e-e282-4e91-915e-56618f79ff94.png)

##### 图3-2 需调用到的5个接口

a）查询字典表接口流程图

用于获取申报类型、申报方式、证件类型、性别、国籍、是否离开公司所在地、返回地风险级别及所属部门的选项数据。

![image](https://user-images.githubusercontent.com/79617492/182995731-586c807a-e58d-457b-8348-786f23b1805b.png)

##### 图3-3 查询字典表接口流程图

b）风险地统计查询接口流程图

用于统计中、高风险地数量以及中高风险地合计数量。

![image](https://user-images.githubusercontent.com/79617492/182995746-9dac3ac6-dbcd-4486-8200-7ee4adb1a7ac.png)

##### 图3-4 风险地统计查询接口流程图

c）查询申报信息接口流程图

用于查询所有员工的申报信息。

![image](https://user-images.githubusercontent.com/79617492/182995755-680a5541-a3d6-443a-87c0-6d0fd46e9b63.png)

##### 图3-5 查询申报信息接口流程图

d）查询省市区信息接口流程图

用于获取省市区信息，作为【人员报务信息】页面中“所在区域”的选项数据。

![image](https://user-images.githubusercontent.com/79617492/182995767-5373069b-f866-4183-ba41-6f707905e490.png)

##### 图3-6 查询省市区信息接口流程图

e）新增人员报务信息接口

用于新增人员报务信息。

![image](https://user-images.githubusercontent.com/79617492/182995785-2e3207ae-d7df-4531-813b-d21c8a453716.png)

##### 图3-7 新增人员报务信息接口流程图

##### 2.3.3 关联（后端）全自动开发平台项目

##### 前提条件： 您已完成创建前端应用项目、创建页面等基本操作。

为展示和前两个案例的不同，本案例选择关联第三方项目的方式来关联后端项目，所关联的第三方项目仍由（后端）全自动开发平台进行开发。在关联第三方项目时，填写好对应服务器信息即可，如下图所示。

![image](https://user-images.githubusercontent.com/79617492/182995797-8000a7f2-3c84-4364-8fba-0312b78b7f72.png)

##### 图3-8 填写对应服务器信息

##### 2.3.4 页面构建、数据绑定

疫情防控功能包含【人员报务信息页面】、【风险地统计页面】和【申报信息查询页面】三个页面的构建，如下图所示。

![image](https://user-images.githubusercontent.com/79617492/182995814-52ca676d-97cf-4c2b-a71d-132c1cd08218.png)

##### 图3-9 疫情防控功能

a）人员报务信息页面

a1）页面构建

通过点击页面开发界面中大纲树选项，即可查看该页面使用到的所有控件，点击控件右侧的眼睛按钮，可显示或隐藏对应控件以展示不同的页面效果；控件的具体配置可根据实际需求进行自定义配置，若不清楚如何配置控件，可点击属性栏文档选项查看对应控件的帮助文档。

##### 说明：您可根据功能开发的实际情况选择面向电脑端或手机端进行设计，本案例选择手机端，如下图所示：

![image](https://user-images.githubusercontent.com/79617492/182995831-b14d2218-96cb-45a4-95b5-4792e4dcb1e8.png)

##### 图3-10 大纲树1

![image](https://user-images.githubusercontent.com/79617492/182995844-e917e17f-b301-4a8e-bc8f-322fbc638154.png)

##### 图3-11 大纲树2

a2）数据绑定

a2-1）设置页面变量

点击页面开发界面上方工具栏“变量设置”选项，设置页面变量。

##### 说明：由于申报类型、申报方式、证件类型、性别、国籍、是否离开公司所在地、返回地风险级别、所属部门的选项数据需通过调用查询字典表接口获取，返回地的选项数据需通过调用查询省市区信息接口获取，所以需要设置页面变量来接收调用接口获取的数据。

![image](https://user-images.githubusercontent.com/79617492/182995861-77c7ae7c-8932-4654-8657-1362e0ca2ae4.png)

##### 图3-12 设置页面变量

a2-2）绑定页面加载前事件

点击“属性栏 > 页面配置”绑定页面加载前事件，分别调用查询字典表数据接口和查询省市区信息接口获取选项数据，使用页面变量接收，如下图所示。

##### 说明：接口地址填写（后端）全自动开发平台中对应接口基本信息下的接口路径即可。

![image](https://user-images.githubusercontent.com/79617492/182995877-b672da00-48ce-4631-90b0-c7abce10be32.png)

##### 图3-13 执行绑定动作1

![image](https://user-images.githubusercontent.com/79617492/182997498-1cca498a-5c4e-4cb4-9d4f-bbdef95258c5.png)

##### 图3-14 执行绑定动作2

a2-3）为控件绑定页面对应的页面变量，以下选择申报类型下拉选择框为样例，其他控件同理

选中“申报类型”下拉选项框，点击属性栏下“属性 > 选项”旁的链接按钮，进入变量绑定页面，选择“页面变量 > 申报类型名称”，单击“确定”即可。

![image](https://user-images.githubusercontent.com/79617492/182997517-3bb745f7-8b20-4a46-8834-d51714d0635a.png)

##### 图3-15 选中申报类型

![image](https://user-images.githubusercontent.com/79617492/182997525-d11be42d-73a3-4f61-8ad9-395dbd69c639.png)

##### 图3-16 变量绑定

a2-4）为申报按钮绑定点击事件

选中申报按钮，在属性栏“属性 > 动作面板”下进行两次绑定动作操作，分别用于调用新增人员报务信息接口和跳转至【风险地统计页面】，如下图所示。

![image](https://user-images.githubusercontent.com/79617492/182997550-59b6203f-1dda-4b26-add3-fdc8b0afb824.png)

##### 图3-17 执行绑定动作1

![image](https://user-images.githubusercontent.com/79617492/182997583-942bdb5b-3b0e-4538-98a6-3bdf6da2a02d.png)

##### 图3-18 执行绑定动作2

b）风险地统计页面

b1）页面构建

本案例中【风险地统计页面】通过多次使用容器、文本控件以及表格控件进行页面构建，您也可以根据实际需求进行自定义设计。

![image](https://user-images.githubusercontent.com/79617492/182997606-b87e5156-6ca9-48df-8e99-d73df42ca744.png)

##### 图3-19 页面构建

b2）数据绑定

b2-1）设置页面变量

下图中三个文本控件均需通过调用风险地统计查询接口来获取数据，所以需要设置页面变量来接收数据，点击页面上方“变量设置 > 页面变量”进行设置即可。

![image](https://user-images.githubusercontent.com/79617492/182997652-3d4fa242-c41c-4c7f-b91e-faa65128af65.png)

##### 图3-20 文本控件

![image](https://user-images.githubusercontent.com/79617492/182997692-1c6c45fb-2801-49a3-840e-592ef38ad7be.png)

##### 图3-21 变量设置

b2-2）为三个文本控件绑定页面变量，以下选择中风险区域数量作为样例，其余两个文本控件同理

选中需绑定页面变量的文本控件，点击属性栏“属性 > 内容”旁的链接按钮，选择页面变量中风险数量即可。

![image](https://user-images.githubusercontent.com/79617492/182997706-5a027050-45e1-43dd-8cc6-4c818cd8f860.png)

##### 图3-22 点击链接按钮

![image](https://user-images.githubusercontent.com/79617492/182997733-93101658-07de-46c6-a719-4e1b6aa71da8.png)

##### 图3-23 变量绑定

b3）为表格控件绑定动作，调用风险地统计查询接口，显示人员报务信息并进行风险地数量统计

选中表格控件，点击属性栏下“属性 > 动作面板”绑定动作按钮，进行获取数据绑定动作操作，如下图所示，其中“数据处理”即为将调用接口得到的数据赋值给三个页面变量。

![image](https://user-images.githubusercontent.com/79617492/182997751-70c9f5bc-3317-41ad-b30d-ab16082a0eb4.png)

##### 图3-24 执行绑定动作

b4）为表格控件中查询全部选项绑定动作，跳转至【申报信息查询页面】

选中表格控件，点击属性栏“属性 > 顶部操作”选项，配置“查看全部”操作条，并为该操作条绑定动作，跳转至【申报信息查询页面】。

![image](https://user-images.githubusercontent.com/79617492/182997775-d151a833-3562-4b3c-b92d-ca67f508a406.png)

##### 图3-25 配置“查看全部”操作条

![image](https://user-images.githubusercontent.com/79617492/182997792-6358200e-3926-46fb-b39e-f608018b291f.png)

##### 图3-26 执行绑定动作

c）申报信息查询页面

c1）页面构建

【申报信息查询页面】仅使用了一个表格组件，主要用于显示所有的人员申报信息，并按条件查询，表格中的字段需自行设置。

![image](https://user-images.githubusercontent.com/79617492/182997802-f80c1224-48c9-4502-9bdc-d812c9c09244.png)

##### 图3-27 页面构建

c2）数据绑定

c2-1）设置页面变量风险级别，用于接收风险级别的选项数据。

c2-2）自定义筛选项配置，并为筛选项“风险级别”绑定页面变量。

c2-3）绑定页面加载前事件，调用查询字典表接口，获取风险级别的选项数据，并赋值给页面变量风险级别。

c2-4）为表格控件绑定事件，调用查询申报信息接口，将所有人员申报信息显示在当前页面。

c2-5）为顶部操作条“返回”绑定事件，跳转至【风险地统计页面】。

##### 说明：由于以上操作均可在前两个页面中数据绑定操作中找到参考，此处不再赘述。

##### 2.3.5 页面预览、功能测试

a）上述所有操作完成后，在【人员报务信息页面】设计界面上方，单击“预览”选项，进行页面预览和功能测试。

![image](https://user-images.githubusercontent.com/79617492/182997853-32d76a8d-fde5-49d6-bf58-da96f30339cc.png)

##### 图3-28 单击“预览”选项

b）预览加载完成后，系统将自动弹出浏览器窗口展示页面，此时您可以输入人员报务信息，并进行相关操作，检测是否可以正常运行。

![image](https://user-images.githubusercontent.com/79617492/182997870-2c5b04ea-d48b-4dc0-8594-8cc4927e8933.png)

##### 图3-29 预览效果1

![image](https://user-images.githubusercontent.com/79617492/182997886-da838820-2559-4b5d-b86f-42c802a430dc.png)

##### 图3-30 预览效果2
