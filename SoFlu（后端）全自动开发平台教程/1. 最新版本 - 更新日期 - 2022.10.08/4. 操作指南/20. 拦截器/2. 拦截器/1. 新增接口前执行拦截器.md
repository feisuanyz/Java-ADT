### 4. 操作指南

#### 4.20 拦截器

#### 4.20.2 拦截器

#### 4.20.2.1 新增接口前执行拦截器

新增接口前执行拦截器，在执行接口时，会优先之前拦截器里面的流程，然后再根据拦截器的响应结果判断是否要继续执行接口的流程。适用于在执行接口前要先执行某个操作，比如执行接口前要先初始化数据，所以在拦截器中编写初始化数据的流程即可。

#### 4.20.2.1.1 前提条件

a）您需要拥有“拦截器”模块的权限。

b）权限由系统管理员在“用户权限中心”系统中配置。

#### 4.20.2.1.2 步骤引导

a）新增接口前执行拦截器

b）接口管理绑定拦截器

#### 4.20.2.1.2.1 新增接口前执行拦截器

a）进入项目管理页面，选择拦截器模块，选中已创建的拦截器模块，单击“+”按钮，选择“新增拦截器”。

![image](https://user-images.githubusercontent.com/79617492/199924107-0d50dbb6-3081-4698-820c-3f939c97b77d.png)

##### 图1-1 单击新增拦截器

b）填写拦截器基本信息，提交拦截器，执行类型选择接口前执行，单击“提交”。

![image](https://user-images.githubusercontent.com/79617492/199924387-9f6958b3-ed95-4083-912f-e0e20a6039f8.png)

##### 图1-2 填写拦截器基本信息

c）单击“进入模型编辑”编辑拦截器流程图。

![image](https://user-images.githubusercontent.com/79617492/199924412-6296dd72-43be-4cf3-afec-5dcc34263e21.png)

##### 图1-3 编辑拦截器流程图

d）在流程图编辑页面，根据需求画拦截器的流程。

![image](https://user-images.githubusercontent.com/79617492/199924438-5113da3b-8fdd-4fd0-aa17-39d790638639.png)

##### 图1-4 根据需求画拦截器的流程

e）单击输出结果组件，选择输出结果。

![image](https://user-images.githubusercontent.com/79617492/199924488-d1c5b87d-41b8-49ae-a0a3-0b0a969b0436.png)

##### 图1-5 选择输出结果

##### 说明：输出结果可以选择默认的输出结果或者自定义的输出结果，但是自定义的输出结果中必须包含result字段，result字段是用来判断拦截器执行完成后是否要继续执行接口。

f）单击输出项值的未选中记录方框，设置输出结果字段值，单击确定。

![image](https://user-images.githubusercontent.com/79617492/199924511-c78c144c-08b7-403d-ade3-47d717e3180f.png)

##### 图1-6 设置输出结果字段值

##### 说明：result字段值为1时，表示继续执行接口操作，result字段值为0时，表示不执行后续接口操作；若无该字段，系统将默认为1，继续执行后续接口操作。

g）拦截器流程图画完之后，单击保存并退出即可。

h）回到编辑拦截器页面，单击“提交”再次提交拦截器信息，然后单击“测试用例”检验拦截器程序是否可以正常运行。

![image](https://user-images.githubusercontent.com/79617492/199924534-2176d14b-da65-458f-9f2b-726e614647f2.png)

##### 图1-7 提交拦截器信息并检验运行状况

#### 4.20.2.1.2.2 接口管理绑定拦截器

a）进入接口管理页面，单击新增接口模块旁边的三个点按钮，选择“拦截器白名单设置”。

![image](https://user-images.githubusercontent.com/79617492/199924555-80333f3a-d759-4025-8a30-1e1f9feb7f85.png)

##### 图1-8 选择“拦截器白名单设置”

b）选择接口前执行的拦截器，并设置拦截还是放行，再选择需要指定的接口，单击应用即可。

![image](https://user-images.githubusercontent.com/79617492/199924580-bf6807e0-bf7b-4c86-99da-7db4c4d88e8f.png)

##### 图1-9 配置拦截器相关信息

```
说明：

b1）一个拦截器可以应用多个接口，勾选需要执行拦截器的接口即可。

b2）拦截：只有勾选的接口会执行拦截器，其它不勾的接口不会执行拦截器。

b3）放行：只有勾选的接口不会执行拦截器，其它不勾选的接口会执行该拦截器
```

##### 注意：切换接口拦截还是接口放行时，系统会清除清除之前的设置，以当前设置为准。
