### 5. 案例场景

#### 5.2 常见案例

#### 5.2.5 生成操作日志

操作日志在每个系统中都是必不可少的，用户在系统中进行每一项操作时，都会调用生成操作日志的程序实时生成对应的操作日志。根据这样的功能特性，可以很好地借助全自动开发平台中的子流程来实现，子流程中专门放置生成操作日志的程序，这样在进行每一项操作时，都会调用该子流程达到生成对应操作日志的效果。下文将为您介绍利用全自动开发平台实现生成操作日志功能的具体操作过程。

#### 5.2.5.1 效果展示

生成操作日志功能效果：通过执行测试接口，调用生成操作日志子流程，即可实现在数据库中保存用户操作记录，如图2-1所示，本实例仅针对后端程序开发，若与前端页面进行联调，即可实现如图1-2所示的效果

![输入图片说明](../../../../images/SoFlu%EF%BC%88%E5%90%8E%E7%AB%AF%EF%BC%89%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202022.10.08/5.%20%E6%A1%88%E4%BE%8B%E5%9C%BA%E6%99%AF/2.%20%E5%B8%B8%E8%A7%81%E6%A1%88%E4%BE%8B/5.%20%E7%94%9F%E6%88%90%E6%93%8D%E4%BD%9C%E6%97%A5%E5%BF%97/image.png)

##### 图1-1 用户操作日志表记录

![输入图片说明](../../../../images/SoFlu%EF%BC%88%E5%90%8E%E7%AB%AF%EF%BC%89%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202022.10.08/5.%20%E6%A1%88%E4%BE%8B%E5%9C%BA%E6%99%AF/2.%20%E5%B8%B8%E8%A7%81%E6%A1%88%E4%BE%8B/5.%20%E7%94%9F%E6%88%90%E6%93%8D%E4%BD%9C%E6%97%A5%E5%BF%97/1-2.png)

##### 图1-2 前端页面效果

#### 5.2.5.2 准备工作

在数据库中准备一张数据表：用户操作日志表sy_log（用于存储用户操作的日志记录），表结构设计及相关数据如下图所示。

用户操作日志表sy_log：

```
CREATE TABLE `sy_log` (
  `auto_id` varchar(24) NOT NULL COMMENT '日志编号',
  `content` varchar(100) DEFAULT NULL COMMENT '内容',
  `log_type` varchar(50) DEFAULT NULL COMMENT '日志类型(1增加2删除3修改4查询5导出6清除历史数据7备份数据库8登录系统9退出系统)',
  `log_time` datetime DEFAULT NULL COMMENT '操作时间',
  `user_id` varchar(24) DEFAULT NULL COMMENT '用户账户',
  `from_ip` varchar(15) DEFAULT NULL COMMENT '来源ip',
  PRIMARY KEY (`auto_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='用户操作日志';
```

![输入图片说明](../../../../images/SoFlu%EF%BC%88%E5%90%8E%E7%AB%AF%EF%BC%89%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202022.10.08/5.%20%E6%A1%88%E4%BE%8B%E5%9C%BA%E6%99%AF/2.%20%E5%B8%B8%E8%A7%81%E6%A1%88%E4%BE%8B/5.%20%E7%94%9F%E6%88%90%E6%93%8D%E4%BD%9C%E6%97%A5%E5%BF%97/1-3.png)

##### 图1-3 表结构设计及相关数据

```
说明：

a）用户操作日志表中的数据在执行测试接口后自动生成。

b）关于日志类型的具体数值说明，您可以根据实际需求自行定义。
```

#### 5.2.5.3 流程图设计概览

因本实例的实现需要用到子流程，所以以下将为您展示两张流程图设计，即生成操作日志子流程的流程设计和测试接口的流程设计。

#### 5.2.5.3.1 生成操作日志子流程

![输入图片说明](../../../../images/SoFlu%EF%BC%88%E5%90%8E%E7%AB%AF%EF%BC%89%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202022.10.08/5.%20%E6%A1%88%E4%BE%8B%E5%9C%BA%E6%99%AF/2.%20%E5%B8%B8%E8%A7%81%E6%A1%88%E4%BE%8B/5.%20%E7%94%9F%E6%88%90%E6%93%8D%E4%BD%9C%E6%97%A5%E5%BF%97/1-4.png)

##### 图1-4 生成操作日志子流程

逻辑描述：

a）为用户操作日志赋值，作为新增操作日志的入参；

b）在用户操作日志表中新增日志记录。

#### 5.2.5.3.2 测试接口

![输入图片说明](../../../../images/SoFlu%EF%BC%88%E5%90%8E%E7%AB%AF%EF%BC%89%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202022.10.08/5.%20%E6%A1%88%E4%BE%8B%E5%9C%BA%E6%99%AF/2.%20%E5%B8%B8%E8%A7%81%E6%A1%88%E4%BE%8B/5.%20%E7%94%9F%E6%88%90%E6%93%8D%E4%BD%9C%E6%97%A5%E5%BF%97/1-5.png)

##### 图1-5 测试接口
