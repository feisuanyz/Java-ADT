### 5. 案例场景

#### 5.2 常见案例

#### 5.2.6 系统站内信推送

系统推送站内信是系统开发中比较常用的功能，后端实现推送站内信的功能是将数据存储到数据库中（新增系统消息表），以方便前端页面调用数据，本节讲述如何使用全自动开发平台开发系统站内信后端功能。

#### 5.2.6.1 效果展示

![输入图片说明](../../../../images/SoFlu%EF%BC%88%E5%90%8E%E7%AB%AF%EF%BC%89%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202022.10.08/5.%20%E6%A1%88%E4%BE%8B%E5%9C%BA%E6%99%AF/2.%20%E5%B8%B8%E8%A7%81%E6%A1%88%E4%BE%8B/6.%20%E7%B3%BB%E7%BB%9F%E7%AB%99%E5%86%85%E4%BF%A1%E6%8E%A8%E9%80%81/image.png)

##### 图1-1 效果展示

上图是APP消息模块推送手工消息的界面展示效果，对于后端开发来说，只需要将数据存储到<系统消息表>中即可，如下图所示：

![输入图片说明](../../../../images/SoFlu%EF%BC%88%E5%90%8E%E7%AB%AF%EF%BC%89%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202022.10.08/5.%20%E6%A1%88%E4%BE%8B%E5%9C%BA%E6%99%AF/2.%20%E5%B8%B8%E8%A7%81%E6%A1%88%E4%BE%8B/6.%20%E7%B3%BB%E7%BB%9F%E7%AB%99%E5%86%85%E4%BF%A1%E6%8E%A8%E9%80%81/1-2.png)

##### 图1-2 系统消息表

#### 5.2.6.2 准备工作

需提前准备功能实现过程中用到的两张数据表：消息推送节点表 bs_message_node（用来存储消息模版消息）、系统消息表sy_message（用来存储推送消息），表结构设计及相关数据如下图所示。

a）消息推送节点表 bs_message_node

```
CREATE TABLE `bs_message_node` (
  `send_node_id` varchar(50) NOT NULL COMMENT '推送节点编号',
  `send_node_name` varchar(100) DEFAULT NULL COMMENT '推送节点名称',
  `send_context` varchar(200) DEFAULT NULL COMMENT '推送内容',
  `message_title` varchar(200) DEFAULT NULL COMMENT '消息标题',
  `message_type` int(11) DEFAULT NULL COMMENT '消息类型',
  `goto_type` int(11) DEFAULT NULL COMMENT '跳转类别',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
  PRIMARY KEY (`send_node_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='消息推送节点表';
```

![输入图片说明](../../../../images/SoFlu%EF%BC%88%E5%90%8E%E7%AB%AF%EF%BC%89%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202022.10.08/5.%20%E6%A1%88%E4%BE%8B%E5%9C%BA%E6%99%AF/2.%20%E5%B8%B8%E8%A7%81%E6%A1%88%E4%BE%8B/6.%20%E7%B3%BB%E7%BB%9F%E7%AB%99%E5%86%85%E4%BF%A1%E6%8E%A8%E9%80%81/1-3.png)

##### 图1-3 表结构及相关信息

b）系统消息表sy_message

```
CREATE TABLE `sy_message` (
  `msg_id` varchar(24) COLLATE utf8_bin NOT NULL COMMENT '消息编号',
  `is_readed` int(11) DEFAULT NULL COMMENT '是否已查阅',
  `title` varchar(100) COLLATE utf8_bin DEFAULT NULL COMMENT '消息标题',
  `context` varchar(100) COLLATE utf8_bin DEFAULT NULL COMMENT '消息内容',
  `message_type` int(11) DEFAULT NULL COMMENT '消息类型',
  `goto_type` int(11) DEFAULT NULL COMMENT '跑转类别',
  `relation_id` varchar(24) COLLATE utf8_bin DEFAULT NULL COMMENT '关联编号',
  `receive_user` varchar(24) COLLATE utf8_bin DEFAULT NULL COMMENT '接收人',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
  `create_user` varchar(24) COLLATE utf8_bin DEFAULT NULL COMMENT '创建人',
 PRIMARY KEY (`msg_id`)
 )ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='系统消息表';
```
