### 5. 案例场景

#### 5.4 综合案例

#### 5.4.2 发送短信验证码

本节实例是结合腾讯云实现发送短信验证码的功能，全自动开发平台不仅可以在平台内部实现功能开发，还可以与外部工具联用以实现用户各种各样的功能需求，体现了全自动开发平台灵活包容、便捷好用的功能特点。实例主要用到了平台的单函数组件、单SQL组件、互斥条件组件，这三种组件的结合也是一种经典搭配，可适用于多种不同的案例场景，同时通过调用平台中的系统函数或自定义函数来实现特定功能。

#### 5.4.2.1 效果展示

通过调用发送短信验证码接口，传入接收短信验证码的手机号，即可实现对指定手机号发送短信验证码的功能，如下图所示。

![输入图片说明](../../../../images/SoFlu%EF%BC%88%E5%90%8E%E7%AB%AF%EF%BC%89%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202022.10.08/5.%20%E6%A1%88%E4%BE%8B%E5%9C%BA%E6%99%AF/4.%20%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B/2-1.png)

##### 图2-1 传入接收短信验证码的手机号

![输入图片说明](../../../../images/SoFlu%EF%BC%88%E5%90%8E%E7%AB%AF%EF%BC%89%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202022.10.08/5.%20%E6%A1%88%E4%BE%8B%E5%9C%BA%E6%99%AF/4.%20%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B/2-2.png)

##### 图2-2 效果展示

#### 5.4.2.2 准备工作

a）提前准备一个开通了短信服务的腾讯云账号，关于如何注册腾讯云账号及开通短信服务可参见[腾讯云文档](https://cloud.tencent.com/document/product/382/37745)(文档中心 > 短信 > 国内短信 > 国内短信快速入门)。

b）提前准备功能实现过程中需要使用到的两张数据表：参数表sy_params（用来配置获取验证码次数上限和验证码有效时长的参数信息）、短信表user_note（用来存储用户手机号、发送短信次数、发送短信时间及短信验证码等信息），表结构设计及相关数据如下图所示。

参数表sy_params：

```
CREATE TABLE `sy_params` (
  `param_id` varchar(24) NOT NULL COMMENT '参数编号',
  `param_remark` varchar(100) DEFAULT '' COMMENT '参数说明',
  `param_value` varchar(50) DEFAULT '' COMMENT '参数值',
  `data_type` varchar(6) DEFAULT '' COMMENT '数据类型',
  `create_user` varchar(24) DEFAULT '' COMMENT '创建人',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
 `update_time` datetime DEFAULT NULL COMMENT '更新时间',
  `update_user` varchar(24) DEFAULT NULL COMMENT '更新人',
  PRIMARY KEY (`param_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='参数表';
```

![输入图片说明](../../../../images/SoFlu%EF%BC%88%E5%90%8E%E7%AB%AF%EF%BC%89%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202022.10.08/5.%20%E6%A1%88%E4%BE%8B%E5%9C%BA%E6%99%AF/4.%20%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B/2-3.png)

##### 图2-3 表结构设计及相关数据

##### 说明：参数表中的配置信息可自行设置，本案例主要配置了verificationCodeDuration 【验证码有效时长（分钟）】和todayVerification【当天获取验证码次数上限】。

短信表user_note：

```
CREATE TABLE `user_note` (
  `mobileSms_id` varchar(255) NOT NULL COMMENT '短信记录Id',
  `receiver_mobile` varchar(255) DEFAULT '' COMMENT '手机号',
  `dayNum` int(11) DEFAULT NULL COMMENT '当天获取验证码次数',
  `create_time` datetime DEFAULT NULL COMMENT '验证码发送时间',
  `verify_code` varchar(255) DEFAULT '' COMMENT '发送的验证码'
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='短信表';
```

![输入图片说明](../../../../images/SoFlu%EF%BC%88%E5%90%8E%E7%AB%AF%EF%BC%89%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202022.10.08/5.%20%E6%A1%88%E4%BE%8B%E5%9C%BA%E6%99%AF/4.%20%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B/2-4.png)

##### 图2-4 表结构设计及相关数据

##### 说明：短信表中的数据在调用接口后自动生成。
