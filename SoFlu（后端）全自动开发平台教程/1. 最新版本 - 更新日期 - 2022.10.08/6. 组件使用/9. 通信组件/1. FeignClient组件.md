### 6. 组件使用

#### 6.9 通信组件

#### 6.9.1 FeignClient组件

FeignClient组件与Nacos、etcd、consul、eureka等多种注册中心搭配使用，当项目启动时会往已配置的注册中心注册当前项目的信息，注册成功后，可通过FeignClient组件调用第三方的接口。

##### 说明：注册中心有多种不同类型，本节以Nacos注册中心作为示例为您介绍FeignClient组件的使用，您可以根据实际需求选择注册中心服务，关于不同注册中心该如何进行配置，请参考《SoFlu（后端）全自动开发平台教程第7.1章：微服务治理》。

#### 6.9.1.1 前提条件

项目中已加载FeignClient组件、Nacos配置资源、Http通信资源，具体操作可以参考《SoFlu（后端）全自动开发平台教程第2.2.2节：如何加载资源》。

#### 6.9.1.2 步骤引导

a）新增Nacos配置资源实例、Http通信资源实例

b）通过FeignClient组件使用Nacos服务

#### 6.9.1.2.1 新增Nacos配置资源实例、Http通信资源实例

a）进入资源实例功能模块，新增Nacos配置资源实例，输入部署Nacos服务的IP地址和端口号即可。

![image](https://user-images.githubusercontent.com/79617492/209934718-3ae0e141-cd94-461b-8a6e-6ad85b533000.png)

##### 图1-1 新增Nacos配置资源实例

```
说明：

a1）isMock：Mock开关，该字段值只能为true或者false，输入其他不生效。

a2）mockReturnResult：Mock开关开启后返回的消息内容。

当调用FeignClient组件相关接口时，若isMock为true，则FeignClient组件直接返回mockReturnResult的消息内容；若isMock为false，则FeignClient组件返回第三方接口的输出结果。
```

b）新增Http通信资源实例，填写调用接口所在项目的项目路径地址即可。

![image](https://user-images.githubusercontent.com/79617492/209934736-b89613a9-1b85-465f-90dd-e13e96c0f944.png)

##### 图1-2 填写调用接口所在项目的项目路径地址

##### 说明：FeignClient组件需使用Http通信资源实例在注册中心服务中找到对应的项目，Http通信资源实例中URL的填写格式为http://项目路径 ，格式必须正确，否则调用接口时会出现报错。

#### 6.9.1.2.2 通过FeignClient组件使用Nacos服务

a）进入窗体视图，选中FeignClient组件，在右侧组件属性栏选择注册中心类型。

![image](https://user-images.githubusercontent.com/79617492/209934767-b6030793-1d9d-4ee0-8685-9cfd7ed6277c.png)

##### 图1-3 选择注册中心类型

b）单击选择记录方框，选择对应的注册中心资源实例。

![image](https://user-images.githubusercontent.com/79617492/209934942-c92b70bd-a0e0-4822-ad11-aa0de6a945d9.png)

##### 图1-4 单击选择记录方框

![image](https://user-images.githubusercontent.com/79617492/209934966-e7012f98-0925-4d6c-866a-fbffc3221cc7.png)

##### 图1-5 选择对应的注册中心资源实例

c）单击未选中记录方框配置http请求参数。

![image](https://user-images.githubusercontent.com/79617492/209935050-819e103b-afd6-4411-896e-35849ffb03ec.png)

##### 图1-6 配置http请求参数

d）系统显示填写数据页面，选择HTTP资源实例。

![image](https://user-images.githubusercontent.com/79617492/209935389-c066fbbb-c4b2-4554-b3e8-0edb0dbd7c89.png)

##### 图1-7 填写数据页面

![image](https://user-images.githubusercontent.com/79617492/210057473-cd3993fe-04a9-43a8-9a8b-07ff83be1895.png)

##### 图1-8 选择HTTP资源实例

e）选择调用接口的Http请求方法。

![image](https://user-images.githubusercontent.com/79617492/210057484-fa095bd4-d54d-42d3-aa01-958c4835a96a.png)

##### 图1-9 选择调用接口的Http请求方法

f）填写调用接口的请求地址以及其它请求参数信息，单击确定即可。

![image](https://user-images.githubusercontent.com/79617492/210057494-ed910798-246a-4952-823c-0f124d8cb346.png)

##### 图1-10 填写相关参数信息

g）运行接口测试用例，查看接口是否可以调用成功。

![image](https://user-images.githubusercontent.com/79617492/210057500-7fde6fae-759d-44ad-85ce-3bab15f94c79.png)

##### 图1-11 运行接口测试用例


```
说明：

g1）只有Nacos注册中心可以直接在平台调用接口进行测试，etcd、consul、eureka注册中心需在本地客户端或本地执行引擎模式下才可以执行接口，更多详情可以参考进阶指南 > 微服务章节章节。

g2）若Mock开关开启，即Nacos配置资源实例中isMock配置值为true时，则输出如下图所示内容，其中data数据为FeignClient组件返回的mock数据，body内容为设置的mock返回消息内容。
```

![image](https://user-images.githubusercontent.com/79617492/210057514-660ebd17-32dc-4215-80fa-fb8f79b24a23.png)

##### 图1-12 查看接口是否可以调用成功
