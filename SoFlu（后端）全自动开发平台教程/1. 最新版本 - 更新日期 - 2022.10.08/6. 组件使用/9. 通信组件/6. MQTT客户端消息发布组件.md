### 6. 组件使用

#### 6.9 通信组件

#### 6.9.6 MQTT客户端消息发布组件

平台系统支持MQTT功能，用户可通过新增MQTT客户端资源实例，然后使用MQTT客户端消息发布组件来发布主题和消息，最后通过MQTT模型的接口来订阅主题和接收消息。

#### 6.9.6.1 操作步骤

a）在项目加载项页面，单击组件 > 添加MQTT客户端消息发布组件，然后单击加载应用。

![image](https://user-images.githubusercontent.com/79617492/229703625-459fa1e0-a92e-481b-99be-73f945278345.png)

##### 图6-1 单击加载应用

b）新增接口，进行流程图编辑，选中MQTT客户端消息发布组件，单击未选中记录。

![image](https://user-images.githubusercontent.com/79617492/229703652-b8e54069-ff44-459f-8c8c-33f5e0bb878b.png)

##### 图6-2 单击未选中记录

c）填写对应数据信息，然后单击确定。

```
字段说明：

c1）主题：自定义发布的主题。

c2）消息体：该主题对应的消息体内容。

c3）服务质量：

c3-1）Qos 0：消息至多传一次，也可不传，也就是该客户端会给服务器最多发送一次消息，或者不发送，但不会有重复消息。

c3-2）Qos 1：消息至少传一次，可以多次，但会重复。也就是该客户端最少会给服务器发送一次消息，或者多几次，消息内容就会重复。

c3-3）Qos 2：消息刚好一次，必须发送，只能发送一次。也就是该客户端会给服务器一条消息，不会不发和多发。

是否保留消息：开启按钮后，MQTT客户端向服务器发布该主题的消息时，则该消息将被永久保存在服务器上，如果没有开启，则消息不会保留。
```

![image](https://user-images.githubusercontent.com/79617492/229703678-e248fdd3-df71-4987-a4f3-bf71b32b9b99.png)

##### 图6-3 填写对应数据信息

d）发布接口，然后执行接口测试用例。

##### 说明：执行接口时，MQTT客户端消息发布组件就会往MQTT服务器发布该主题和消息。

![image](https://user-images.githubusercontent.com/79617492/229703704-f861bd50-4e6f-4f7f-8ba6-5bc0ce180d0f.png)

##### 图6-4 执行接口测试用例
