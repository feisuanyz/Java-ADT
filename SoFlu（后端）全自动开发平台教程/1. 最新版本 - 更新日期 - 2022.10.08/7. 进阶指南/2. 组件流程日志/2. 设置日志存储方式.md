### 7. 进阶指南

#### 7.2 组件流程日志

#### 7.2.2 设置日志存储方式.

通过对默认配置组中activityLog配置项的参数值进行不同的设置，便可以实现组件流程日志的三种存储方式，即本地存储、Elasticsearch/Mongodb存储、自定义存储，本节将为您分别介绍如何设置这三种存储方式。

#### 7.2.2.1 本地存储

##### 本地存储是流程日志的默认存储方式。

a）进入项目“配置组管理”功能模块，双击默认配置组，即可在activityLog配置项中查看到本地存储路径。

![image](https://user-images.githubusercontent.com/79617492/211254059-074fde77-5535-4bc4-b3cc-fc41aa80bc70.png)

##### 图2-1 进入项目“配置组管理”功能模块

![image](https://user-images.githubusercontent.com/79617492/211254075-ba4da03f-7613-4e89-a933-2ab4a7270e04.png)

##### 图2-2 查看本地存储路径

```
说明：

a1）storageType：即日志存储类型，支持填写file（本地存储方式）、elasticsearch、mongodb、customized（自定义存储方式），若填写了其他值，则系统默认使用本地存储方式。

a2）filePath：即日志文件的本地存储相对路径，项目部署至本地后，日志文件将生成在部署包目录下，${项目路径}将自动替换为当前项目的项目路径。

a3）若未找到activityLog配置项，您可以单击同步按钮后重新查看。
```

#### 7.2.2.2 Elasticsearch/Mongodb存储

##### 前提条件：项目中已创建Elasticsearch/Mongodb资源实例。

##### 说明：若您选择Elasticsearch/Mongodb存储方式，则按照以下填写格式修改默认配置组中activityLog配置项的参数值即可。

存储到mongodb的填写格式为：

```
{"storageType":"mongodb","resourceName":"资源实例名称","collectionName":"表名，例如：activityLog"}
```

存储到elasticsearch的填写格式为：

```
{"storageType":"elasticsearch","resourceName":"资源实例名称","indexType":"log","indexName":"例如：activityLog"}
```

#### 7.2.2.3 自定义存储

```
说明：

a1）若本地存储、Elasticsearch/Mongodb存储无法满足您的需求，您可以选择通过代码自定义其他存储方式，代码需要实现ActivityLogStorage接口后通过插件方式上传至平台，ActivityLogStorage接口的具体内容可通过加载项开发包获取，如下图所示。

a2）导入插件操作可参见《SoFlu（后端）全自动开发平台教程第4.8.2节：导入自定义插件》，插件导入平台后，需加载至对应项目才可生效。

a3）自定义存储方式同样需要设置activityLog参数值，见下填写方式。
```

![image](https://user-images.githubusercontent.com/79617492/211254100-75e0841a-95da-478f-ae6d-41543a3c4f72.png)

##### 图2-3 加载项开发包

自定义存储activityLog填写方式为：

```
{"storageType":"customized","implClass":"实现类"}
```
