### 7. 进阶指南

#### 7.7 事务

#### 7.7.2 事务的隔离级别

隔离级别是指若干个并发的事务之间的隔离程度，系统支持事务设置隔离级别，通过设置隔离级别，可以极大的避免出现逻辑处理失败导致的脏数据等问题。

#### 7.7.2.1 操作步骤

a）新增嵌入式中间件资源实例，下拉到最底部，事务隔离级别选择 “读未提交”，填写完其他信息后，单击提交即可。

```
说明：

a1）关于新增嵌入式中间件资源实例请参考文档“操作指南/15资源实例/1新增资源实例/新增嵌入式中间件资源”。

a2）事务隔离级别只有嵌入式中间件、数据库中间件选择嵌入式中间件、动态数据库中间件组件才能设置。
事务隔离级别说明：

a2-1）读未提交：一个事务可以读取到另一个未提交事务的数据。

a2-2）读已提交：一个事务可以读取到另一个已提交事务的数据。

a2-3）可重复读：在开始读取数据（事务开启）时，不再允许修改操作。

a2-4）序列化：最高的事务隔离级别，事务只能一个接着一个执行，不能并发执行。

a2-5）当事务隔离级别为空，且“开启事务”组件里无事务传播行为时，则到提交事务组件时才一起提交数据。

a2-6）当事务隔离级别为空，且“开启事务”组件有事务传播行为时，则为对应类型SQL数据库自身默认的事务隔离级别，比如SQL类型是MySQL的，则事务隔离级别是可重复读。

a2-7）事务隔离级别只对当前事务有效，不会影响到其它事务的执行。
```

![image](https://user-images.githubusercontent.com/79617492/211450953-d89bdb43-f6f0-4155-95bf-69b4adf1ec88.png)

##### 图2-1 选择 “读未提交”

b）在SQL管理页面里，SQL组的中间件选择 “测试嵌入式中间件”。

##### 说明：因为测试嵌入式中间件的资源实例选择了隔离级别，所以当该SQL组的中间件选择了对应的嵌入式中间件时，则该SQL组下所有SQL的事务隔离级别是相同的。

![image](https://user-images.githubusercontent.com/79617492/211450969-07618b08-a80e-42eb-a301-40e5f7a93019.png)

##### 图2-2 选择 “测试嵌入式中间件”

c）新增A接口。

说明：举例A接口逻辑：执行单SQL组件，对数据库表里新增数据，然后执行单函数组件，休眠30S，最后提交事务，输出结果。

![image](https://user-images.githubusercontent.com/79617492/211451008-2dc803a8-c8ab-4bfc-b62b-f0ee2bcf926c.png)

##### 图2-3 新增A接口

d）新增B接口。

##### 说明：举例B接口逻辑：执行单SQL组件，查询数据库表数据，然后提交事务，输出结果。

![image](https://user-images.githubusercontent.com/79617492/211451033-342b23b9-9632-4ab1-998c-110f33916668.png)

##### 图2-4 新增B接口

e）打开双页签，先执行A接口测试用例，接着执行B接口测试用例。

##### 说明：当前打开双页签，执行AB接口是为了演示事务的隔离级别如何设置和使用，您根据实际需求设置对应的事务隔离级别即可。

![image](https://user-images.githubusercontent.com/79617492/211451054-1d1b4ddc-06e7-4702-addc-cc35ec27563b.png)

##### 图2-5 执行A/B接口测试用例

f）查看B接口测试用例的响应结果。

##### 说明：当前举例的AB接口的事务隔离级别为“读未提交”，因此执行A接口新增表数据后休眠30S，但还未提交事务，然后执行B接口时可以查询到A接口未提交事务的数据，其它隔离级别同理。

![image](https://user-images.githubusercontent.com/79617492/211451074-4bb426bd-c456-4dda-89c6-dc14265d3ad6.png)

##### 图2-6 查看响应结果
