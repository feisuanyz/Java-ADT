### 7. 进阶指南

#### 7.7 事务

#### 7.7.3 事务的传播级别

传播级别是指如果在开始当前事务之前，一个事务上下文已经存在，此时有若干选项可以指定一个事务性方法的执行行为。系统支持事务设置传播级别，通过设置传播级别，可以极大的避免出现逻辑处理失败导致的脏数据等问题。

#### 7.7.3.1 操作步骤

a）新增子流程C，“开启事务”组件里选择 “MANDATORY” 的事务传播行为，其它同理。

```
传播级别说明：

a1）REQUIRED：如果当前存在事务，则加入该事务；如果不存在事务，则创建一个新的事务。

a2）SUPPORTS：如果当前存在事务，则加入该事务；如果不存在事务，则无事务执行。

a3）MANDATORY：如果当前存在事务，则加入该事务；如果不存在事务，则抛出异常。

a4）REQUIRES_NEW：如果当前存在事务，则将这个事务挂起，重新创建一个新的事务。

a5）NOT_SUPPORTED：如果当前存在事务，则将这个事务挂起，然后无事务执行。

a6）NEVER：如果当前存在事务，则抛出异常。

a7）子流程C逻辑：先新增表数据，最后提交事务。
```

![image](https://user-images.githubusercontent.com/79617492/211451280-742e5f0f-2304-4447-983d-b23e658f2e05.png)

##### 图3-1 选择 “MANDATORY” 的事务传播行为

b）新增D接口。

```
说明：

b1）接口D 逻辑：先新增表数据，然后执行子流程C。

b2）D接口无事务执行。
```

![image](https://user-images.githubusercontent.com/79617492/211451297-8f42f391-da5c-45ec-ab00-6581ea46215e.png)

##### 图3-2 新增D接口

c）发布接口，然后执行接口测试用例，查看响应内容。

##### 说明：因为 D接口不存在事务，所以子流程C会抛出异常。当前D接口和子流程C只为了演示传播级别，其它传播级别同理，您可以根据需求进行设置。

![image](https://user-images.githubusercontent.com/79617492/211451315-3010ded0-a5d2-4d14-adad-2d268566bb9b.png)

##### 图3-3 执行接口测试用例
