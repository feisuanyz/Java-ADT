### 8. 高阶专题

#### 8.5 自定义资源实例

通过自行定义的资源实例，先上传至平台进行审核，只有平台审核通过的资源实例，才能上架该平台使用。

#### 8.5.1 前提条件

自定义资源实例需要下载如下Demo工程包和加载项开发包，具体如下：

a）资源实例Demo工程包下载地址：demo-resource.zip

b）下载加载项开发包：在(后端)全自动开发平台中，单击右上角下载加载项开发包，如图5-1所示。

![输入图片说明](../../../images/SoFlu%EF%BC%88%E5%90%8E%E7%AB%AF%EF%BC%89%E5%BC%80%E5%8F%91%E5%B9%B3%E5%8F%B0/1.%20%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%20-%20%E6%9B%B4%E6%96%B0%E6%97%A5%E6%9C%9F%20-%202022.10.08/8.%20%E9%AB%98%E9%98%B6%E4%B8%93%E9%A2%98/5-1.png)

##### 图5-1 下载加载项开发包

#### 8.5.2 操作步骤

a）在Pom文件中增加依赖包。

包名：com.feisuanyz.flow.resource

类名：Resource

```
<dependency>
     <groupId>com.feisuanyz.flow</groupId>
     <artifactId>flow-core-cmpt</artifactId>
     <version>${version}</version>
     <scope>provided</scope>
     <systemPath>${开发辅助工具路径}/flow-core-cmpt-${version}.jar</systemPath>
</dependency>
```

b）实现Resource接口。

包名：com.feisuanyz.flow.resource

类名：Resource

实现方法：

```
/**
 * 创建资源实例
 * @param parameters 参数
 * @return 实例对象
 * @throws ResourceException
 */
T newInstance(ResourceParameter parameters) throws ResourceException;
```

c）获取资源实例。

平台提供了工具类ResourceUtil.java调用相应的方法，获取到的对象是Object，强转成对应的实例对象即可。

方法示例如下：

```
/**
 * 获取资源实例
 * @param resourceName 资源名称
 * @return 资源实例
 */
public static Object getResourceInstance(String resourceName){
    return getResourceInstance(ProcessInfoHolder.get().getProjectId(),resourceName);
}

/**
 * 获取资源实例
 * @param projectId 项目编号
 * @param resourceName 资源名称
 * @return 资源实例
 */
public static Object getResourceInstance(String projectId,String resourceName){
    try {
        return getResourceInstanceMethod.invoke(null, projectId, resourceName);
    } catch (Exception e) {
        throw new ResourceException(ExceptionUtils.getFullStackTrace(e));
    }
}
```

d）定义资源实例方式。

资源实例的定义需要按照以下xml格式进行描述，文件名必须为resources.xml，然后存放到项目中的resources目录下，一起打成Jar包上传到平台即可。

正确示例如下：
