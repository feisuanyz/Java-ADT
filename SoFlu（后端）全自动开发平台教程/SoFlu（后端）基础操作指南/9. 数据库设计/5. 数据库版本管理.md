### 5. 数据库版本管理

#### 5.1 对比数据库版本

系统提供该功能，您可以对比不同的数据库版本。

##### 前提条件

a）您需要拥有“数据库设计”模块的权限。

b）权限由系统管理员在“用户权限中心”系统中配置。

##### 5.1.1 操作步骤

a）选择“项目管理 > 数据库设计”，系统显示“数据库设计”页面，如图5-1所示：

![image](https://user-images.githubusercontent.com/79617492/173731015-afeb2548-7ee7-4faf-a904-f1baac17e9fc.png)

##### 图5-1 数据库设计页面

b）选择一个数据库，单击如图5-2所示标号1的红框，选择“数据库版本”：

![image](https://user-images.githubusercontent.com/79617492/173731038-9baa23af-8aea-44f1-87d0-e48de01e0211.png)

##### 图5-2 选择数据库版本

c）系统显示“设计版本管理”页面，单击“版本对比”，如图5-3所示：

![image](https://user-images.githubusercontent.com/79617492/173731049-facd26bc-6fb7-4f69-9d00-7d0d203d6004.png)

##### 图5-3 设计版本管理页面

d）系统显示“版本比较”页面，分别选择“初始版本”和“增量版本”，如图5-4所示：

![image](https://user-images.githubusercontent.com/79617492/173731070-6ccb887a-13f7-45d5-9cc9-ef7ac955c055.png)

##### 图5-4 版本比较页面

e）单击“比较”，页面下方显示两版本之间的变化信息，如图5-5所示：

![image](https://user-images.githubusercontent.com/79617492/173731110-8e864828-8f17-48fe-84fc-ee9b65130294.png)

##### 图5-5 版本变化信息

##### 说明：您可以单击“导出文件”导出变化脚本

#### 5.2 同步数据库版本

系统提供该功能，您可以将数据库的最新版本同步到服务器。但同步表之前，请检查服务器数据库的空间确保有剩余，如果空间不足会导致同步表失败。

##### 前提条件

a）您需要拥有“数据库设计”模块的权限。

b）权限由系统管理员在“用户权限中心”系统中配置。

##### 5.2.1 操作步骤

a）选择“项目管理 > 数据库设计”，系统显示“数据库设计”页面，如图5-6所示：

![image](https://user-images.githubusercontent.com/79617492/173731135-d2ceb915-4a21-4972-8a09-573f80daba13.png)

##### 图5-6 数据库设计页面

b）选择需要同步的数据库，单击如图5-7所示标号1的红框，选择“数据库版本”：

![image](https://user-images.githubusercontent.com/79617492/173731153-9faa4c6c-2283-4dbb-a352-30c44a0f74bd.png)

##### 图5-7 选择数据库版本

c）系统显示“设计版本管理”页面，单击“保存新版本”，如图5-8所示：

![image](https://user-images.githubusercontent.com/79617492/173731170-31959d72-4c08-4ade-ba4e-be2d7fde69d8.png)

##### 图5-8 设计版本管理页面

##### 说明：若您已保存新版本，则不需再次保存新版本，系统会直接显示“同步”按钮。

d）单击“同步”，系统弹出“数据库同步配置”对话框，根据实际需要选择数据库同步方式，再次单击“同步”，如图5-9所示：

![image](https://user-images.githubusercontent.com/79617492/173731223-3afeb5a5-2fba-41cb-b1e4-55ec8f12bb1c.png)

##### 图5-9 数据库同步配置

e）系统弹出“版本对比”对话框，单击“同步”，如图5-10所示：

![image](https://user-images.githubusercontent.com/79617492/173731235-c3c9f77c-a711-4827-9201-5f29cc842a67.png)

##### 图5-10 版本对比

f）系统提示“确定同步？”，单击“确定”，如图5-11所示：

![image](https://user-images.githubusercontent.com/79617492/173731407-a1109cfc-27b0-4b3c-960a-92ee6c63aa76.png)

##### 图5-11 是否确定同步

g）系统显示同步日志，提示“同步完成”，如图5-12所示：

![image](https://user-images.githubusercontent.com/79617492/173731431-6cc0dd17-570e-442a-92be-7f1c3d237fc6.png)

##### 图5-12 同步完成日志

#### 5.3 重建版本线

系统提供该功能，您可以重建数据库的版本线。

##### 前提条件

a）您需要拥有“数据库设计”模块的权限。

b）权限由系统管理员在“用户权限中心”系统中配置。

##### 5.3.1 操作步骤

a）选择“项目管理 > 数据库设计”，系统显示“数据库设计”页面，如图5-13所示：

![image](https://user-images.githubusercontent.com/79617492/173731473-ed90124c-f419-4aa1-bc81-e55ee5b5dd11.png)

##### 图5-13 数据库设计页面

b）选择需要重建版本线的数据库，单击如图5-14所示标号1的红框，选择“数据库版本”：

![image](https://user-images.githubusercontent.com/79617492/173731531-c39047d6-7b7c-40a3-aacc-cd5d036e830c.png)

##### 图5-14  选择数据库版本

c）系统显示“设计版本管理”页面，单击“重建版本线”，如图5-15所示：

![5-15](https://www.feisuanyz.com/fsimage/zc-image/cz_10_5_3_03.png)

##### 图5-15 设计版本管理页面

d）系统弹出不可逆信息提示，单击“确定” --> 系统提示操作成功。

##### 注意：重建版本基线会清除掉当前项目的所有版本信息，且该操作不可逆，需要谨慎操作。

#### 5.4 查看重建记录

系统提供该功能，您可以查看数据库版本的重建记录。

##### 前提条件

a）您需要拥有“数据库设计”模块的权限。

b）权限由系统管理员在“用户权限中心”系统中配置。

##### 5.4.1 操作步骤

a）选择“项目管理 > 数据库设计”，系统显示“数据库设计”页面，如图5-14所示：

![5-14](https://www.feisuanyz.com/fsimage/zc-image/cz_10_4_4_01.png)

##### 图5-14 数据库设计页面

b）选择需要查看重建记录的数据库，单击如图5-15所示标号1的红框，选择“数据库版本”：

![5-15](https://www.feisuanyz.com/fsimage/zc-image/cz_10_5_1_02.png)

##### 图5-15 选择数据库版本

c）系统显示“设计版本管理”页面，单击“查看重建记录”，如图5-16所示：

![5-16](https://www.feisuanyz.com/fsimage/zc-image/cz_10_5_4_02.png)

##### 图5-16 设计版本管理页面

d）系统弹出“历史重建信息”页面，上面会显示各个版本的创建时间。

#### 5.5 导出表DDL脚本信息

系统提供该功能，您可以导出不同数据库版本中数据表的DDL脚本信息。

##### 前提条件

a）您需要拥有“数据库设计”模块的权限。

b）权限由系统管理员在“用户权限中心”系统中配置。

##### 5.5.1 操作步骤

a）选择“项目管理 > 数据库设计”，系统显示“数据库设计”页面，如图5-17所示：

![5-17](https://www.feisuanyz.com/fsimage/zc-image/cz_10_4_4_01.png)

##### 图5-17 数据库设计页面

b）选择需要导出DDL脚本信息的数据库，单击如图1-2所示标号1的红框，选择“数据库版本”，如图5-18所示：

![5-18](https://www.feisuanyz.com/fsimage/zc-image/cz_10_5_1_02.png)

##### 图5-18 选择数据库版本

c）系统显示“设计版本管理”页面，单击不同创建时间数据库版本右侧的“导出”按钮，如图5-19所示：

![5-19](https://www.feisuanyz.com/fsimage/zc-image/cz_10_5_5_02.png)

##### 图5-19 设计版本管理页面

d）系统显示“DDL脚本导出”页面，您可以选择需导出的数据表，同时对导出的内容进行筛选，如图5-20所示：

![5-20](https://www.feisuanyz.com/fsimage/zc-image/cz_10_5_5_03.png)

##### 图5-20 DDL脚本导出页面

e）设置好筛选条件之后，单击“预览”，您可以看到将导出的DDL脚本信息，如图5-21所示：

![5-21](https://www.feisuanyz.com/fsimage/zc-image/cz_10_5_5_04.png)

##### 图5-21 预览DDL脚本信息

f）单击“导出”，系统会自动下载该DDL脚本文件。

#### 5.6 查看表信息

系统提供该功能，您可以查看选定数据库版本中数据表的信息。

##### 前提条件

a）您需要拥有“数据库设计”模块的权限。

b）权限由系统管理员在“用户权限中心”系统中配置。

##### 5.5.1 操作步骤

a）选择“项目管理 > 数据库设计”，系统显示“数据库设计”页面，如图5-22所示：

![5-22](https://www.feisuanyz.com/fsimage/zc-image/cz_10_4_4_01.png)

##### 图5-22 数据库设计页面

b）选择需要查看表信息的数据库，单击如图5-23所示标号1的红框，选择“数据库版本”：

![5-23](https://www.feisuanyz.com/fsimage/zc-image/cz_10_5_5_02.png)

##### 图5-23 选择数据库版本

c）系统显示“设计版本管理”页面，单击“查看全量详情”，如图5-24所示：

![5-24](https://www.feisuanyz.com/fsimage/zc-image/cz_10_5_6_03.png)

##### 图5-24 设计版本管理页面

d）系统弹出“版本变更记录详情”页面，在该页面可查看新增表信息和对应的SQL脚本，如图5-25所示：

![5-25](https://www.feisuanyz.com/fsimage/zc-image/cz_10_5_6_04.png)

##### 图5-25 版本变更记录详情页面
