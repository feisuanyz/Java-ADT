### 2. 工具组件

#### 2.3 子流程批处理组件的使用

##### 2.3.1 子流程批处理组件

系统提供该功能，您可以在系统中利用子流程批处理组件进行可视化开发。

##### 2.3.2 前提条件

a）您需要拥有“流程编辑器”功能的权限。

b）您需要在子流程管理模块建有所需的子流程。

c）权限由系统管理员在“用户权限中心”系统中配置。

##### 2.3.3 操作步骤

a）在窗体视图左侧的“组件列表”中“工具”栏目下，找到子流程批处理组件，拖拽至绘图面板，如图3-1所示：

![image](https://user-images.githubusercontent.com/79617492/180144252-4dbe6d0b-91b5-4a8d-9b62-b11999ccefa2.png)

##### 图3-1 找到子流程批处理组件

b）拖拽所需的其他组件至绘图面板，连接好组件的流程图，如图3-2所示：

![image](https://user-images.githubusercontent.com/79617492/180144280-0495627b-0b44-4da3-891b-e35260aa7616.png)

##### 图3-2 连接组件流程图

##### 说明：此处我们选择了一个单SQL组件和一个输出结果组件作为样例，用于列表查询数据库中的记录。

c）选中子流程批处理组件，根据项目需求填写子流程批处理组件的名称和描述，如图3-3所示：

![image](https://user-images.githubusercontent.com/79617492/180144295-2d9f8763-ba0f-4076-a2f3-5c235ed919af.png)

##### 图3-3 填写子流程批处理组件的基本信息

d）单击”资源实例“处的选择记录方框，选择已连好的线程池资源，如图3-4、3-5所示：

![image](https://user-images.githubusercontent.com/79617492/180144321-44b4a4fb-d971-4a84-9bf3-6392153b6886.png)

##### 图3-4 选择子流程名称

![image](https://user-images.githubusercontent.com/79617492/180144395-edfae435-9a79-4b6a-8b58-beb67f8b13b3.png)

##### 图3-5 示例

e）单击“子流程名称”处的选择记录方框，选择已建好的子流程，如图3-6、3-7所示：

![image](https://user-images.githubusercontent.com/79617492/180144401-ed90a097-5601-40e6-b2a2-fb1b9e75406c.png)

##### 图3-6 选择子流程名称

![image](https://user-images.githubusercontent.com/79617492/180144418-2af1516e-d81b-4993-864f-8109eb2ced12.png)

##### 图3-7 示例

##### 说明：此处我们选择了往数据库插入一条记录的子流程，子流程批处理组件的使用可以实现向数据库中同时插入多条记录。

f）单击“子流程入参列表”处的录入参数方框，选择一个对应子流程入参的列表对象，如图3-8、3-9所示：

![image](https://user-images.githubusercontent.com/79617492/180144454-5f30ebbb-9311-42fa-8731-c9c91964fa5e.png)

##### 图3-8 设置子流程入参列表

![image](https://user-images.githubusercontent.com/79617492/180144468-f99009b2-f250-4708-b7fd-9f70f175f861.png)

##### 图3-9 选择列表对象

##### 说明：列表对象可以是一个函数的执行结果、一个输入的表达式或者配置的入口参数等，可根据项目需求自行设置。此示例通过配置入口参数来设置入参列表，如图3-10所示：

![image](https://user-images.githubusercontent.com/79617492/180144488-cedf6796-039a-4c7d-8c59-c653cd570bac.png)

##### 图3-10 示例

h）配置单SQL组件。

##### 说明：除子流程批处理组件外，您可以根据项目需求自行选择组件自行配置，此处我们仅用单SQL组件作为示例，并设置了列表查询的SQL信息，如图1-11所示：

![image](https://user-images.githubusercontent.com/79617492/180145558-529534a3-f676-4a90-9638-bdb364e9dd6d.png)

##### 图3-11 示例

i）配置输出结果组件。

##### 注意：若输出结果需要引用某组件的执行结果，则需要在参数选择页面，选择相应的页签同时选择相应的执行结果，如图1-12所示：

![image](https://user-images.githubusercontent.com/79617492/180146177-8e6f37b1-290a-41b9-9f72-8de0da5f89c7.png)

##### 图3-12 示例

j）流程图编辑完成后，单击“保存并退出”。

k）最后提交并发布该接口即可。
