### 2. 工具组件

#### 2.6 计数器组件的使用

##### 2.6.1 计数器组件

系统提供该功能，您可以在系统中利用计数器组件进行可视化开发。

##### 2.6.2 前提条件

a）您需要拥有“流程编辑器”功能的权限。

b）权限由系统管理员在“用户权限中心”系统中配置。

##### 2.6.3 操作步骤

a）在窗体视图左侧的“组件列表”中“工具”栏目下，找到计数器组件，拖拽至绘图面板，如图6-1所示：

![6-1](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_1.png)

##### 图6-1 找到计数器组件

b）拖拽所需的其他组件至绘图面板，连接好组件的流程图，如图6-2所示：

![6-2](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_2.png)

##### 图6-2 连接组件流程图

##### 说明：此处以演示计数器组件的递减功能作为示例，用到的组件有：单SQL组件、互斥条件组件、赋值组件和输出结果组件，其中单SQL组件用于列表查询数据库中学生信息表的记录，互斥条件组件用于判断计数器索引值是否小于等于0，若小于等于0，则输出赋值组件中List对象的值；若大于0，则进入循环，并将计数器索引值赋值给赋值组件中的List对象。

c）选中单SQL组件，单击“SQL信息”处的未选中记录方框，选择SQL名称，如图6-3所示：

![6-3](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_3.png)

##### 图6-3 配置SQL信息

d）选中计数器组件，单击“循环流程变量”处的录入参数方框，选择一个对应的流程变量，如图6-4所示：

![6-4](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_4.png)

##### 图6-4 选择流程变量

#####说明：循环流程变量一般为一个集合对象或数组对象，此处示例用到的是单SQL组件的执行结果，即查询结果列表，如图6-5所示：

![6-5](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_5.png)

##### 图6-5 示例

e）根据具体项目需求，选择操作符，如图6-6所示：

![6-6](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_6.png)

##### 图6-6 选择操作符

##### 说明：此处示例用的是递减操作符。

f）设置互斥条件组件的两条流转条件，如图6-7、6-8所示：

![6-7](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_7.png)

##### 图6-7 设置流转条件1

![6-8](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_8.png)

##### 图6-8 设置流转条件2

g）选中赋值组件，单击“数据模型”处的选择记录方框，选择数据模型，如图6-9所示：

![6-9](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_9.png)

##### 图6-9 选择数据模型

##### 说明：使用赋值组件时，一般需要提前创建实体模型，此处示例用到的实体模型配置如图6-10所示：

![6-10](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_10.png)

##### 图6-10 实体模型配置示例

h）单击“赋值”处的模型赋值方框，为数据模型进行赋值。

##### 说明：选择添加数据的方式分为三种：往数组中追加数据、向数组中的指定下标插入数据、向数组下标范围内插入数据，此处示例选择的是第一种，如图6-11所示，同时将计数器索引值赋值给了实体模型的num参数，如图6-12、6-13所示：

![6-11](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_11.png)

##### 图6-11 选择添加数据的方式

![6-12](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_13.png)

##### 图6-12 参数选择页面

![6-13](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_12.png)

##### 图6-13 填写模型数据页面

i）选中输出结果组件，单击“响应结果”处的三等号按钮，选择响应结果，一般选择系统默认响应结果，也可自行设置，如图6-14所示：

![6-14](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_14.png)

##### 图6-14 选择响应结果

j）单击“输出项值”处的未选中记录方框，配置输出项值。

##### 说明：若需要引用某组件的执行结果，则需要在参数选择页面，选择相应的页签同时选择相应的执行结果，此处示例需要引用赋值组件的执行结果，如图6-15所示：

![6-15](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_15.png)

##### 图6-15 引用赋值组件的执行结果

k）流程图编辑完成后，单击“保存并退出”。

l）提交并发布该接口。

m）本示例测试用例的响应内容如图6-16所示：

![6-16](https://www.feisuanyz.com/fsimage/zc-image/cz_22_1_8_16.png)

##### 图6-16 本示例最终响应内容
